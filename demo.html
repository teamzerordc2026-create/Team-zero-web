<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEAM ZERO | Complete School Engine - WINNING DEMO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== ROOT VARIABLES ===== */
        :root {
            --primary: #004080;
            --secondary: #d4af37;
            --light: #f4f6f9;
            --dark: #1a1a1a;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --radius: 8px;
        }
        
        /* ===== RESET & BASE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--light);
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 25px;
            border-radius: var(--radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 9999;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            max-width: 400px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            border-left: 5px solid var(--success);
        }
        
        .toast.error {
            border-left: 5px solid var(--danger);
        }
        
        .toast.info {
            border-left: 5px solid var(--primary);
        }
        
        /* ===== SCREEN CONTAINERS ===== */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: opacity 0.5s ease;
            overflow-y: auto;
        }
        
        /* ===== SCREEN 1: POWERFUL INTRO ===== */
        #intro-screen {
            background: linear-gradient(135deg, var(--primary) 0%, #002040 100%);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .intro-container {
            max-width: 900px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .logo-large {
            font-size: 4.5rem;
            margin-bottom: 20px;
            color: var(--secondary);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }
        
        .intro-title {
            font-size: 3.2rem;
            margin-bottom: 15px;
            font-weight: 800;
            line-height: 1.2;
        }
        
        .intro-subtitle {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 300;
        }
        
        .intro-highlights {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin: 40px 0;
        }
        
        .highlight-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 12px;
            text-align: left;
            border-left: 4px solid var(--secondary);
            transition: transform 0.3s, background 0.3s;
        }
        
        .highlight-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .highlight-card i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }
        
        .highlight-card h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .btn-hero {
            background: var(--secondary);
            color: #000;
            border: none;
            padding: 18px 45px;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }
        
        .btn-hero:hover {
            background: #ffd700;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.6);
        }
        
        /* ===== SCREEN 2: LOGIN ===== */
        #login-screen {
            background: linear-gradient(rgba(0, 40, 80, 0.95), rgba(0, 20, 40, 0.98)), url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 900;
        }
        
        .login-box {
            background: white;
            padding: 50px;
            border-radius: 16px;
            width: 90%;
            max-width: 450px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .login-logo {
            font-size: 3.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .login-title {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #444;
        }
        
        .input-group input,
        .input-group select {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        .input-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 64, 128, 0.1);
        }
        
        .btn-login {
            width: 100%;
            padding: 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn-login:hover {
            background: #003366;
        }
        
        .login-note {
            margin-top: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: var(--radius);
            font-size: 0.9rem;
            color: #666;
            text-align: left;
        }
        
        /* ===== SCREEN 3: MAIN APP ===== */
        #app-screen {
            display: flex;
            flex-direction: column;
            z-index: 800;
        }
        
        /* HEADER */
        .app-header {
            background: white;
            border-bottom: 3px solid var(--secondary);
            padding: 0 30px;
            height: 70px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .brand-logo {
            font-size: 2rem;
            color: var(--primary);
        }
        
        .brand-text {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .brand-badge {
            background: var(--secondary);
            color: #000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
        }
        
        .status-badge {
            background: #e8f5e9;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: #155724;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .btn-control {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 8px 18px;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-control:hover {
            background: var(--primary);
            color: white;
        }
        
        .btn-control.highlight {
            background: var(--secondary);
            color: #000;
            border-color: var(--secondary);
        }
        
        .btn-control.highlight:hover {
            background: #ffd700;
        }
        
        /* MAIN CONTENT AREA */
        .app-main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        /* SIDEBAR */
        .sidebar {
            width: 260px;
            background: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
            padding-top: 20px;
            overflow-y: auto;
        }
        
        .nav-item {
            padding: 18px 25px;
            cursor: pointer;
            border-left: 4px solid transparent;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1rem;
        }
        
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: rgba(255, 255, 255, 0.3);
        }
        
        .nav-item.active {
            background: rgba(255, 255, 255, 0.15);
            border-left-color: var(--secondary);
            font-weight: 600;
        }
        
        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        /* CONTENT AREA */
        .content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: #f9fafc;
        }
        
        .module {
            display: none;
            animation: fadeIn 0.4s;
        }
        
        .module.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* MODULE HEADERS */
        .module-header {
            margin-bottom: 30px;
        }
        
        .module-header h1 {
            color: var(--primary);
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .module-header p {
            color: #666;
            font-size: 1.1rem;
        }
        
        /* CARDS */
        .card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            border-top: 5px solid var(--primary);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-header h2 {
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        /* BUTTONS */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: #003366;
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-warning {
            background: var(--warning);
            color: #000;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        /* STATS GRID */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .stat-number {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .stat-card.up .stat-number {
            color: var(--success);
        }
        
        .stat-card.down .stat-number {
            color: var(--danger);
        }
        
        .stat-label {
            color: #666;
            font-size: 1rem;
        }
        
        /* TABLES */
        .table-container {
            overflow-x: auto;
            border-radius: var(--radius);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: #f1f7ff;
            color: var(--primary);
            font-weight: 700;
            padding: 16px;
            text-align: left;
            border-bottom: 2px solid #eaeaea;
        }
        
        td {
            padding: 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        /* TAGS */
        .tag {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .tag-success {
            background: #d4edda;
            color: #155724;
        }
        
        .tag-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .tag-danger {
            background: #f8d7da;
            color: #721c24;
        }
        
        .tag-info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        /* WEBSITE PREVIEW */
        .website-preview {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .website-header {
            background: var(--primary);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .website-nav {
            display: flex;
            gap: 30px;
        }
        
        .website-nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }
        
        .website-nav a:hover {
            color: var(--secondary);
        }
        
        .website-hero {
            background: linear-gradient(rgba(0, 64, 128, 0.9), rgba(0, 32, 64, 0.9)), url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            padding: 80px 40px;
            text-align: center;
            color: white;
        }
        
        .website-hero h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
        }
        
        .website-content {
            padding: 40px;
        }
        
        .page-section {
            margin-bottom: 40px;
        }
        
        .page-section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        /* MODALS */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            width: 90%;
            max-width: 700px;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            color: var(--primary);
            margin: 0;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: #999;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        /* ===== SCREEN 4: QUOTE/PRICING ===== */
        #quote-screen {
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 700;
            padding: 40px;
        }
        
        .quote-container {
            max-width: 1000px;
            width: 100%;
        }
        
        .quote-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .quote-header h1 {
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 15px;
        }
        
        .quote-header p {
            color: #666;
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .pricing-card {
            background: white;
            border: 2px solid #eee;
            border-radius: 16px;
            padding: 35px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        
        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .pricing-card.featured {
            border-color: var(--secondary);
            background: #fffdf6;
        }
        
        .featured-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--secondary);
            color: #000;
            padding: 8px 25px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
        }
        
        .pricing-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
        }
        
        .pricing-price {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 25px 0;
        }
        
        .pricing-price span {
            font-size: 1rem;
            color: #666;
            font-weight: 400;
        }
        
        .pricing-features {
            text-align: left;
            margin: 30px 0;
        }
        
        .pricing-features li {
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .pricing-features li i {
            color: var(--success);
        }
        
        .btn-quote {
            width: 100%;
            padding: 18px;
            font-size: 1.1rem;
            font-weight: 700;
            margin-top: 20px;
        }
        
        .quote-actions {
            text-align: center;
            margin-top: 40px;
        }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 1024px) {
            .intro-highlights {
                grid-template-columns: 1fr;
            }
            
            .intro-title {
                font-size: 2.5rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .app-header {
                padding: 0 15px;
                flex-wrap: wrap;
                height: auto;
                padding: 15px;
            }
            
            .header-controls {
                order: 3;
                width: 100%;
                justify-content: center;
                margin-top: 15px;
            }
            
            .sidebar {
                width: 70px;
            }
            
            .nav-item span {
                display: none;
            }
            
            .content-area {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .pricing-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Notification Container -->
    <div id="toast-container"></div>
    
    <!-- ===== SCREEN 1: INTRO ===== -->
    <div id="intro-screen" class="screen">
        <div class="intro-container">
            <div class="logo-large">
                <i class="fas fa-school"></i>
            </div>
            <h1 class="intro-title">Stop Renting Your School's Future</h1>
            <p class="intro-subtitle">Own the Complete School Engine. Pay Once. Use Forever.</p>
            
            <div class="intro-highlights">
                <div class="highlight-card">
                    <i class="fas fa-hand-holding-usd"></i>
                    <h3>ðŸ’° Pay Once, Own Forever</h3>
                    <p>No more termly fees. A lifetime license that becomes a permanent asset for your school.</p>
                </div>
                <div class="highlight-card">
                    <i class="fas fa-wifi-slash"></i>
                    <h3>âš¡ Built for Zimbabwe</h3>
                    <p>Full offline functionality that works during load-shedding and poor internet connections.</p>
                </div>
                <div class="highlight-card">
                    <i class="fas fa-cubes"></i>
                    <h3>ðŸŽ¯ Everything Included</h3>
                    <p>Complete management system + professional school website in one affordable bundle.</p>
                </div>
            </div>
            
            <p>See why over 50 schools have switched from subscription traps to ownership.</p>
            <button class="btn-hero" onclick="showScreen('login-screen')">
                <i class="fas fa-play-circle"></i> START THE WINNING DEMO
            </button>
        </div>
    </div>
    
    <!-- ===== SCREEN 2: LOGIN ===== -->
    <div id="login-screen" class="screen hidden">
        <div class="login-box">
            <div class="login-logo">
                <i class="fas fa-shield-alt"></i>
            </div>
            <h1 class="login-title">Team Zero CSE Pro</h1>
            <p class="login-subtitle">Enter demo credentials to experience the complete system</p>
            
            <div class="input-group">
                <label for="username"><i class="fas fa-user"></i> Username</label>
                <input type="text" id="username" value="admin" readonly>
            </div>
            
            <div class="input-group">
                <label for="password"><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="password" value="********" readonly>
            </div>
            
            <button class="btn-login" onclick="login()">
                <i class="fas fa-sign-in-alt"></i> SECURE LOGIN
            </button>
            
            <div class="login-note">
                <p><strong>Demo Note:</strong> This is a fully functional demo of the Complete School Engine. All data is simulated to show real-world usage.</p>
                <p style="margin-top: 10px; color: var(--success);">
                    <i class="fas fa-database"></i> Status: <strong>Database Connected (Local Server)</strong>
                </p>
            </div>
        </div>
    </div>
    
    <!-- ===== SCREEN 3: MAIN APPLICATION ===== -->
    <div id="app-screen" class="screen hidden">
        <!-- APP HEADER -->
        <header class="app-header">
            <div class="brand">
                <div class="brand-logo">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="brand-text">TEAM ZERO</div>
                <div class="brand-badge">COMPLETE SCHOOL ENGINE</div>
            </div>
            
            <div class="status-badge">
                <div class="status-dot"></div>
                OFFLINE MODE ACTIVE
            </div>
            
            <div class="header-controls">
                <button class="btn-control" onclick="simulateOffline()">
                    <i class="fas fa-plug"></i> Simulate Power Cut
                </button>
                <button class="btn-control highlight" onclick="showScreen('quote-screen')">
                    <i class="fas fa-dollar-sign"></i> Get Your Quote
                </button>
                <button class="btn-control" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </header>
        
        <!-- MAIN APP AREA -->
        <div class="app-main">
            <!-- SIDEBAR NAVIGATION -->
            <nav class="sidebar">
                <div class="nav-item active" onclick="showModule('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" onclick="showModule('website')">
                    <i class="fas fa-globe"></i>
                    <span>School Website</span>
                </div>
                <div class="nav-item" onclick="showModule('students')">
                    <i class="fas fa-user-graduate"></i>
                    <span>Student Management</span>
                </div>
                <div class="nav-item" onclick="showModule('fees')">
                    <i class="fas fa-money-check-alt"></i>
                    <span>Fees & Payments</span>
                </div>
                <div class="nav-item" onclick="showModule('attendance')">
                    <i class="fas fa-clipboard-check"></i>
                    <span>Attendance</span>
                </div>
                <div class="nav-item" onclick="showModule('reports')">
                    <i class="fas fa-chart-line"></i>
                    <span>Academic Reports</span>
                </div>
                <div class="nav-item" onclick="showModule('finance')">
                    <i class="fas fa-calculator"></i>
                    <span>Financial Management</span>
                </div>
                <div class="nav-item" onclick="showModule('communications')">
                    <i class="fas fa-sms"></i>
                    <span>Communications</span>
                </div>
                <div class="nav-item" onclick="showModule('settings')">
                    <i class="fas fa-cog"></i>
                    <span>System Settings</span>
                </div>
            </nav>
            
            <!-- CONTENT AREA -->
            <main class="content-area" id="content-area">
                <!-- DASHBOARD MODULE -->
                <div id="dashboard" class="module active">
                    <div class="module-header">
                        <h1>School Command Center</h1>
                        <p>Term 1, 2026 â€¢ Harare High School â€¢ All Systems Operational</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-user-graduate"></i>
                            <div class="stat-number" id="totalStudents">482</div>
                            <div class="stat-label">Total Enrollment</div>
                            <div style="color: var(--success); margin-top: 10px;">
                                <i class="fas fa-arrow-up"></i> 12% increase from last term
                            </div>
                        </div>
                        <div class="stat-card up">
                            <i class="fas fa-money-bill-wave"></i>
                            <div class="stat-number" id="feesCollected">$12,450</div>
                            <div class="stat-label">Fees Collected (Jan 2026)</div>
                            <div style="color: var(--success); margin-top: 10px;">
                                <i class="fas fa-check-circle"></i> 78% collection rate
                            </div>
                        </div>
                        <div class="stat-card down">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div class="stat-number" id="outstandingFees">$3,200</div>
                            <div class="stat-label">Outstanding Fees</div>
                            <div style="color: var(--danger); margin-top: 10px;">
                                <i class="fas fa-bell"></i> <span id="studentsWithBalance">45</span> students with balances
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-chart-line"></i>
                            <div class="stat-number">98%</div>
                            <div class="stat-label">Average Attendance</div>
                            <div style="color: var(--success); margin-top: 10px;">
                                <i class="fas fa-calendar-check"></i> Today: 475/482 present
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Recent Activity Log</h2>
                            <button class="btn btn-secondary" onclick="showToast('View Full Log', 'This would display the complete activity history', 'info')">
                                <i class="fas fa-history"></i> View Full Log
                            </button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>User</th>
                                    <th>Action</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="activityLog">
                                <!-- Activity log will be populated here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Quick Actions</h2>
                        </div>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn btn-success" onclick="showModule('fees')">
                                <i class="fas fa-money-bill"></i> Record New Payment
                            </button>
                            <button class="btn btn-primary" onclick="showModule('students')">
                                <i class="fas fa-user-plus"></i> Register New Student
                            </button>
                            <button class="btn btn-warning" onclick="showModule('attendance')">
                                <i class="fas fa-clipboard-list"></i> Mark Today's Attendance
                            </button>
                            <button class="btn btn-danger" onclick="showModule('finance')">
                                <i class="fas fa-file-invoice-dollar"></i> View Debtors List
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- SCHOOL WEBSITE MODULE -->
                <div id="website" class="module">
                    <div class="module-header">
                        <h1>Professional School Website</h1>
                        <p>Your 3-page professional website included with the Complete School Engine</p>
                    </div>
                    
                    <div class="website-preview">
                        <div class="website-header">
                            <div style="font-weight: 700; font-size: 1.5rem;">Harare High School</div>
                            <div class="website-nav">
                                <a href="#" onclick="showToast('Home Page', 'This would navigate to the home page', 'info')">Home</a>
                                <a href="#" onclick="showToast('About Page', 'This would navigate to the about us page', 'info')">About Us</a>
                                <a href="#" onclick="showToast('Academics Page', 'This would navigate to the academics page', 'info')">Academics</a>
                                <a href="#" onclick="showToast('Admissions Page', 'This would navigate to the admissions page', 'info')">Admissions</a>
                                <a href="#" onclick="showToast('Contact Page', 'This would navigate to the contact page', 'info')">Contact</a>
                                <a href="#" style="color: var(--secondary);" onclick="showToast('Parent Portal', 'This would open the parent portal login', 'info')">Parent Portal</a>
                            </div>
                        </div>
                        
                        <div class="website-hero">
                            <h1>Strive for Excellence</h1>
                            <p style="font-size: 1.3rem; max-width: 700px; margin: 0 auto;">
                                A leading educational institution in Zimbabwe providing quality education since 1995.
                            </p>
                            <div style="margin-top: 30px;">
                                <button class="btn btn-success" style="margin-right: 15px;" onclick="showToast('Apply Now', 'This would open the online application form', 'success')">
                                    Apply Now
                                </button>
                                <button class="btn btn-primary" onclick="showToast('Parent Portal', 'This would open the parent portal login page', 'info')">
                                    Parent Portal Login
                                </button>
                            </div>
                        </div>
                        
                        <div class="website-content">
                            <div class="page-section">
                                <h2>Welcome to Harare High School</h2>
                                <p>Our mission is to provide a holistic education that develops students academically, morally, and socially. With state-of-the-art facilities and dedicated staff, we prepare students for success in a rapidly changing world.</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 30px;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 2.5rem; color: var(--primary); font-weight: 700;">482</div>
                                        <div>Students Enrolled</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2.5rem; color: var(--primary); font-weight: 700;">42</div>
                                        <div>Qualified Teachers</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 2.5rem; color: var(--primary); font-weight: 700;">98%</div>
                                        <div>Pass Rate</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="page-section">
                                <h2>Latest News & Announcements</h2>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px;">
                                    <div style="border: 1px solid #eee; padding: 20px; border-radius: 8px;">
                                        <h3 style="color: var(--primary);">Term 1 Begins</h3>
                                        <p style="color: #666; margin: 10px 0;">January 10, 2026</p>
                                        <p>Welcome back students and staff for the first term of 2026. Please check the notice board for class lists and timetables.</p>
                                        <button class="btn btn-sm btn-primary" onclick="showToast('Read More', 'This would expand the full article', 'info')" style="margin-top: 10px; padding: 5px 15px; font-size: 0.9rem;">Read More</button>
                                    </div>
                                    <div style="border: 1px solid #eee; padding: 20px; border-radius: 8px;">
                                        <h3 style="color: var(--primary);">Parent-Teacher Meetings</h3>
                                        <p style="color: #666; margin: 10px 0;">January 25, 2026</p>
                                        <p>Scheduled meetings to discuss student progress. Please book your time slot through the parent portal.</p>
                                        <button class="btn btn-sm btn-primary" onclick="showToast('Book Appointment', 'This would open the appointment booking system', 'info')" style="margin-top: 10px; padding: 5px 15px; font-size: 0.9rem;">Book Now</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="page-section">
                                <h2>Contact Information</h2>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-top: 20px;">
                                    <div>
                                        <p><strong>Address:</strong> 123 Learning Avenue, Harare, Zimbabwe</p>
                                        <p><strong>Phone:</strong> +263 242 123456</p>
                                        <p><strong>Email:</strong> info@hararehigh.co.zw</p>
                                        <button class="btn btn-secondary" onclick="showToast('Contact Form', 'This would open the contact form', 'info')" style="margin-top: 10px;">
                                            <i class="fas fa-envelope"></i> Send Message
                                        </button>
                                    </div>
                                    <div>
                                        <div id="map" style="height: 200px; background: #f0f0f0; border-radius: 8px; display: flex; justify-content: center; align-items: center; color: #666; cursor: pointer;" onclick="showToast('Map View', 'This would open Google Maps with school location', 'info')">
                                            <i class="fas fa-map-marked-alt" style="font-size: 2rem; margin-right: 10px;"></i>
                                            Google Maps Integration Active
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Website Management</h2>
                            <button class="btn btn-success" onclick="openWebsiteEditor()">
                                <i class="fas fa-edit"></i> Edit Website Content
                            </button>
                        </div>
                        <p>Your professional school website is included with the Complete School Engine. You have full control to:</p>
                        <ul style="margin-top: 15px; padding-left: 20px;">
                            <li>Update news and announcements</li>
                            <li>Edit page content</li>
                            <li>Upload photos and galleries</li>
                            <li>Manage staff email addresses</li>
                            <li>Integrate with Google Maps</li>
                            <li>Link directly to the Parent Portal</li>
                        </ul>
                    </div>
                </div>
                
                <!-- STUDENT MANAGEMENT MODULE -->
                <div id="students" class="module">
                    <div class="module-header">
                        <h1>Student Management</h1>
                        <p>Manage student records, registration, classes, and guardian information</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Student Database</h2>
                            <div>
                                <button class="btn btn-success" onclick="openModal('register-student-modal')">
                                    <i class="fas fa-user-plus"></i> Register New Student
                                </button>
                                <button class="btn btn-primary" style="margin-left: 10px;" onclick="exportStudentList()">
                                    <i class="fas fa-file-export"></i> Export List
                                </button>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                            <input type="text" id="studentSearch" placeholder="ðŸ” Search by name, ID, class or guardian..." style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onkeyup="searchStudents()">
                            <select id="classFilter" style="padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="filterStudents()">
                                <option>All Classes</option>
                                <option>Form 1</option>
                                <option>Form 2</option>
                                <option>Form 3</option>
                                <option>Form 4</option>
                                <option>Form 5</option>
                                <option>Form 6</option>
                            </select>
                            <select id="statusFilter" style="padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="filterStudents()">
                                <option>All Status</option>
                                <option>Active</option>
                                <option>Graduated</option>
                                <option>Transferred</option>
                            </select>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Student ID</th>
                                        <th>Full Name</th>
                                        <th>Class</th>
                                        <th>Guardian</th>
                                        <th>Contact</th>
                                        <th>Payment Account</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentTableBody">
                                    <!-- Student rows will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                            <div style="color: #666;">
                                Showing <span id="studentCount">5</span> of <span id="totalStudentCount">482</span> students
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn btn-secondary" onclick="previousPage()">
                                    <i class="fas fa-chevron-left"></i> Previous
                                </button>
                                <button class="btn btn-secondary" onclick="nextPage()">
                                    Next <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Student Registration Portal</h2>
                        </div>
                        <p>Parents can register new students directly through your school website's portal. The information flows directly into your system.</p>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: var(--radius); margin-top: 20px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">Online Registration Features</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Online application forms
                                </div>
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Document upload (birth certificate, photo)
                                </div>
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Automatic student ID generation
                                </div>
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Email confirmation to parents
                                </div>
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Application status tracking
                                </div>
                                <div>
                                    <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                    Integration with fee system
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" style="margin-top: 20px;" onclick="showToast('Online Portal', 'This would open the online student registration portal', 'info')">
                                <i class="fas fa-external-link-alt"></i> View Online Registration Portal
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- FEES & PAYMENTS MODULE -->
                <div id="fees" class="module">
                    <div class="module-header">
                        <h1>Fees & Payments Management</h1>
                        <p>Track fee payments, generate receipts, and manage billing</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card up">
                            <i class="fas fa-money-bill-wave"></i>
                            <div class="stat-number" id="feesCollectedModule">$12,450</div>
                            <div class="stat-label">Total Collected (Jan 2026)</div>
                        </div>
                        <div class="stat-card down">
                            <i class="fas fa-exclamation-circle"></i>
                            <div class="stat-number" id="outstandingFeesModule">$3,200</div>
                            <div class="stat-label">Outstanding Balance</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-percentage"></i>
                            <div class="stat-number" id="collectionRate">78%</div>
                            <div class="stat-label">Collection Rate</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <div class="stat-number" id="studentsWithBalanceModule">45</div>
                            <div class="stat-label">Students with Balances</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Record New Payment</h2>
                            <button class="btn btn-primary" onclick="viewAllTransactions()">
                                <i class="fas fa-file-invoice"></i> View All Transactions
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                            <div>
                                <div class="input-group">
                                    <label>Select Student</label>
                                    <select id="paymentStudent" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="updatePaymentInfo()">
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="input-group">
                                    <label>Payment Amount ($)</label>
                                    <input type="number" id="paymentAmount" value="150.00" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updatePaymentAmount()">
                                </div>
                                
                                <div class="input-group">
                                    <label>Payment Method</label>
                                    <select id="paymentMethod" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="showPaymentDetails()">
                                        <option value="Cash">Cash</option>
                                        <option value="Bank Transfer">Bank Transfer</option>
                                        <option value="Ecocash">Ecocash</option>
                                        <option value="Zipit">Zipit</option>
                                        <option value="OneMoney">OneMoney</option>
                                        <option value="Cheque">Cheque</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div>
                                <div class="input-group">
                                    <label>Term</label>
                                    <select id="paymentTerm" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);">
                                        <option>Term 1, 2026</option>
                                        <option>Term 2, 2026</option>
                                        <option>Term 3, 2026</option>
                                    </select>
                                </div>
                                
                                <div class="input-group">
                                    <label>Payment Date</label>
                                    <input type="date" id="paymentDate" value="2026-01-17" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);">
                                </div>
                                
                                <div class="input-group">
                                    <label id="referenceLabel">Reference/Notes</label>
                                    <input type="text" id="paymentReference" placeholder="e.g., Ecocash reference number" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);">
                                </div>
                                
                                <div id="ecocashDetails" style="display: none; background: #f8f9fa; padding: 15px; border-radius: var(--radius); margin-top: 10px;">
                                    <p><strong>Ecocash Payment Instructions:</strong></p>
                                    <p>1. Dial *151# and select Send Money</p>
                                    <p>2. Enter School Ecocash: <strong id="schoolEcocash">0785 306 061</strong></p>
                                    <p>3. Enter Amount: $<span id="ecocashAmount">150.00</span></p>
                                    <p>4. Enter Reference: <span id="ecocashReference">Student Name</span></p>
                                    <button class="btn btn-sm btn-secondary" onclick="changeEcocashNumber()" style="margin-top: 10px;">
                                        <i class="fas fa-edit"></i> Change Ecocash Number
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 25px;">
                            <button class="btn btn-success" style="padding: 15px 40px; font-size: 1.1rem;" onclick="processPayment()">
                                <i class="fas fa-print"></i> Generate Receipt & Complete Payment
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Recent Transactions</h2>
                            <div style="display: flex; gap: 10px;">
                                <select id="transactionFilter" style="padding: 10px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="filterTransactions()">
                                    <option>Last 7 Days</option>
                                    <option>This Month</option>
                                    <option>Last Month</option>
                                    <option>All Time</option>
                                </select>
                                <button class="btn btn-secondary" onclick="exportTransactions()">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Receipt #</th>
                                        <th>Date</th>
                                        <th>Student</th>
                                        <th>Amount</th>
                                        <th>Method</th>
                                        <th>Term</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="transactionTableBody">
                                    <!-- Transactions will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- ATTENDANCE MODULE -->
                <div id="attendance" class="module">
                    <div class="module-header">
                        <h1>Attendance Management</h1>
                        <p>Track daily attendance, generate reports, and monitor student presence</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Daily Class Register</h2>
                            <div style="display: flex; gap: 15px;">
                                <select id="attendanceClass" style="padding: 10px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="loadClassAttendance()">
                                    <option value="Form 3B">Form 3B</option>
                                    <option value="Form 3A">Form 3A</option>
                                    <option value="Form 2A">Form 2A</option>
                                    <option value="Form 1A">Form 1A</option>
                                </select>
                                <input type="date" id="attendanceDate" value="2026-01-17" style="padding: 10px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="loadClassAttendance()">
                                <button class="btn btn-success" onclick="saveAttendance()">
                                    <i class="fas fa-save"></i> Save Register
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Student Name</th>
                                        <th>Present</th>
                                        <th>Absent</th>
                                        <th>Late</th>
                                        <th>Reason for Absence</th>
                                    </tr>
                                </thead>
                                <tbody id="attendanceTableBody">
                                    <!-- Attendance rows will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <strong>Summary:</strong> <span id="presentCount">45</span> Present | <span id="absentCount">1</span> Absent | <span id="lateCount">1</span> Late
                                </div>
                                <div>
                                    <strong>Attendance Rate:</strong> <span id="attendanceRate">95.7</span>%
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Attendance Reports</h2>
                            <button class="btn btn-primary" onclick="generateAttendanceReport()">
                                <i class="fas fa-chart-bar"></i> Generate Monthly Report
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div style="text-align: center; padding: 20px; border: 1px solid #eee; border-radius: var(--radius);">
                                <div style="font-size: 2rem; color: var(--primary); font-weight: 700;" id="weeklyAttendance">98%</div>
                                <div>This Week</div>
                            </div>
                            <div style="text-align: center; padding: 20px; border: 1px solid #eee; border-radius: var(--radius);">
                                <div style="font-size: 2rem; color: var(--primary); font-weight: 700;" id="monthlyAttendance">96.5%</div>
                                <div>This Month</div>
                            </div>
                            <div style="text-align: center; padding: 20px; border: 1px solid #eee; border-radius: var(--radius);">
                                <div style="font-size: 2rem; color: var(--success); font-weight: 700;">â†‘ 2.3%</div>
                                <div>vs. Last Term</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">Term Attendance Summary</h3>
                            <div style="background: #f0f7ff; padding: 15px; border-radius: var(--radius);">
                                <div id="attendanceSummary">
                                    <!-- Attendance summary will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- REPORTS MODULE -->
                <div id="reports" class="module">
                    <div class="module-header">
                        <h1>Academic Reports</h1>
                        <p>Generate term reports, report cards, and academic performance analytics</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Generate Term Report</h2>
                            <button class="btn btn-primary" onclick="bulkPrintReports()">
                                <i class="fas fa-print"></i> Bulk Print Reports
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                            <div>
                                <div class="input-group">
                                    <label>Select Student</label>
                                    <select id="reportStudent" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="loadStudentMarks()">
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                                
                                <div class="input-group">
                                    <label>Term</label>
                                    <select id="reportTerm" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);">
                                        <option>Term 1, 2026</option>
                                        <option>Term 2, 2026</option>
                                        <option>Term 3, 2026</option>
                                    </select>
                                </div>
                                
                                <div class="input-group">
                                    <label>Class Teacher's Comment</label>
                                    <textarea id="teacherComment" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius); height: 100px;">A solid performance this term. Tinotenda has shown excellent improvement in Mathematics and English. Should focus more on Science practicals.</textarea>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Enter Marks (%)</h3>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <div class="input-group">
                                        <label>Mathematics</label>
                                        <input type="number" id="mathMark" value="78" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                    <div class="input-group">
                                        <label>English Language</label>
                                        <input type="number" id="englishMark" value="85" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                    <div class="input-group">
                                        <label>Science</label>
                                        <input type="number" id="scienceMark" value="65" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                    <div class="input-group">
                                        <label>History</label>
                                        <input type="number" id="historyMark" value="72" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                    <div class="input-group">
                                        <label>Shona</label>
                                        <input type="number" id="shonaMark" value="88" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                    <div class="input-group">
                                        <label>Geography</label>
                                        <input type="number" id="geographyMark" value="60" min="0" max="100" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" oninput="updateReportStats()">
                                    </div>
                                </div>
                                
                                <div style="margin-top: 20px; background: #f8f9fa; padding: 15px; border-radius: var(--radius);">
                                    <div style="display: flex; justify-content: space-between;">
                                        <div><strong>Average Score:</strong></div>
                                        <div id="averageScore" style="font-size: 1.5rem; color: var(--primary); font-weight: 700;">74.7%</div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                                        <div><strong>Grade:</strong></div>
                                        <div id="gradeLetter" style="font-size: 1.5rem; color: var(--success); font-weight: 700;">B</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-success" style="padding: 15px 40px; font-size: 1.1rem;" onclick="generateReportCard()">
                                <i class="fas fa-file-pdf"></i> Generate & Print Report Card
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Report Templates</h2>
                            <button class="btn btn-primary" onclick="addReportTemplate()">
                                <i class="fas fa-plus"></i> Add New Template
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div style="border: 1px solid #eee; padding: 20px; border-radius: var(--radius); text-align: center;">
                                <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <h3>Standard Term Report</h3>
                                <p style="color: #666; margin: 10px 0;">Complete academic performance report</p>
                                <button class="btn btn-secondary" onclick="previewTemplate('standard')">Preview</button>
                            </div>
                            
                            <div style="border: 1px solid #eee; padding: 20px; border-radius: var(--radius); text-align: center;">
                                <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                                    <i class="fas fa-chart-pie"></i>
                                </div>
                                <h3>Progress Report</h3>
                                <p style="color: #666; margin: 10px 0;">Mid-term progress analysis</p>
                                <button class="btn btn-secondary" onclick="previewTemplate('progress')">Preview</button>
                            </div>
                            
                            <div style="border: 1px solid #eee; padding: 20px; border-radius: var(--radius); text-align: center;">
                                <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                                    <i class="fas fa-award"></i>
                                </div>
                                <h3>Merit Certificate</h3>
                                <p style="color: #666; margin: 10px 0;">For top performing students</p>
                                <button class="btn btn-secondary" onclick="previewTemplate('merit')">Preview</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- FINANCIAL MANAGEMENT MODULE -->
                <div id="finance" class="module">
                    <div class="module-header">
                        <h1>Financial Management</h1>
                        <p>Track income, expenses, generate financial reports, and manage debtors</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card up">
                            <i class="fas fa-arrow-down"></i>
                            <div class="stat-number" id="incomeThisMonth">$12,450</div>
                            <div class="stat-label">Income (This Month)</div>
                        </div>
                        <div class="stat-card down">
                            <i class="fas fa-arrow-up"></i>
                            <div class="stat-number" id="expensesThisMonth">$8,200</div>
                            <div class="stat-label">Expenses (This Month)</div>
                        </div>
                        <div class="stat-card up">
                            <i class="fas fa-chart-line"></i>
                            <div class="stat-number" id="netProfit">$4,250</div>
                            <div class="stat-label">Net Profit</div>
                        </div>
                        <div class="stat-card down">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div class="stat-number" id="outstandingReceivables">$3,200</div>
                            <div class="stat-label">Outstanding Receivables</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Debtors List</h2>
                            <button class="btn btn-danger" onclick="sendDebtReminders()">
                                <i class="fas fa-paper-plane"></i> Send Reminders
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Class</th>
                                        <th>Amount Owed</th>
                                        <th>Due Since</th>
                                        <th>Parent Contact</th>
                                        <th>Payment Account</th>
                                        <th>Last Reminder</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="debtorsTableBody">
                                    <!-- Debtors will be populated here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="background: #fff3cd; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-lightbulb" style="color: var(--warning); font-size: 1.2rem;"></i>
                                <div>
                                    <strong>Pro Tip:</strong> Use the automated SMS reminder system to send bulk reminders to all parents with outstanding fees. Saves time and improves collections.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Income vs Expense Report (Jan 2026)</h2>
                            <select id="financePeriod" style="padding: 10px; border: 1px solid #ddd; border-radius: var(--radius);" onchange="updateFinanceReport()">
                                <option>January 2026</option>
                                <option>December 2025</option>
                                <option>November 2025</option>
                                <option>Q4 2025</option>
                            </select>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px;">
                            <div>
                                <div id="financeChart" style="height: 300px; background: #f8f9fa; border-radius: var(--radius); display: flex; justify-content: center; align-items: center; color: #666; cursor: pointer;" onclick="showFinanceChart()">
                                    <div style="text-align: center;">
                                        <i class="fas fa-chart-bar" style="font-size: 3rem; margin-bottom: 15px; color: var(--primary);"></i>
                                        <div>Income vs Expense Chart Visualization</div>
                                        <small>Click to view detailed chart</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Breakdown</h3>
                                <div style="margin-bottom: 20px;" id="incomeBreakdown">
                                    <!-- Income breakdown will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- COMMUNICATIONS MODULE -->
                <div id="communications" class="module">
                    <div class="module-header">
                        <h1>Communications</h1>
                        <p>Send SMS alerts, email announcements, and manage parent communications</p>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Send SMS Announcements</h2>
                            <div style="color: #666;">
                                <i class="fas fa-sms"></i> SMS Credits: <strong id="smsCredits">247</strong> remaining
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label>Select Recipients</label>
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="allParents" checked onchange="updateRecipientCount()"> All Parents
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="form3Parents" onchange="updateRecipientCount()"> Form 3 Parents Only
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="feeBalanceParents" onchange="updateRecipientCount()"> Parents with Fee Balances
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="checkbox" id="customList" onchange="updateRecipientCount()"> Custom List
                                </label>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label>SMS Message (160 character limit)</label>
                            <textarea id="smsMessage" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius); height: 100px;" oninput="updateCharCount()">Reminder: Parent-Teacher meetings this Friday, Jan 25. Please book your time slot through the parent portal. - Harare High School</textarea>
                            <div style="text-align: right; margin-top: 5px; color: #666;">
                                <span id="charCount">123</span> characters | Approximately <span id="smsCount">1</span> SMS
                            </div>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px;">
                            <div style="color: #666;">
                                <i class="fas fa-users"></i> Will be sent to: <strong id="recipientCount">482</strong> parents
                            </div>
                            <button class="btn btn-success" style="padding: 12px 30px;" onclick="sendSMSAnnouncement()">
                                <i class="fas fa-paper-plane"></i> Send SMS Now
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Recent Communications</h2>
                            <button class="btn btn-primary" onclick="viewCommunicationHistory()">
                                <i class="fas fa-history"></i> View Full History
                            </button>
                        </div>
                        
                        <div id="communicationsList">
                            <!-- Communications will be populated here -->
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Parent Portal</h2>
                            <button class="btn btn-primary" onclick="openParentPortal()">
                                <i class="fas fa-external-link-alt"></i> Open Portal
                            </button>
                        </div>
                        
                        <p>Parents can access the portal through your school website to:</p>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                View student attendance
                            </div>
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                Check fee balances and pay online
                            </div>
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                Download report cards
                            </div>
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                Receive announcements
                            </div>
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                Book parent-teacher meetings
                            </div>
                            <div>
                                <i class="fas fa-check-circle" style="color: var(--success); margin-right: 8px;"></i>
                                Update contact information
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: #f0f7ff; border-radius: var(--radius);">
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Portal Statistics</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <div>
                                    <div style="font-weight: 700;">342</div>
                                    <div style="font-size: 0.9rem; color: #666;">Active Parent Users</div>
                                </div>
                                <div>
                                    <div style="font-weight: 700;">$8,450</div>
                                    <div style="font-size: 0.9rem; color: #666;">Paid via Portal (This Term)</div>
                                </div>
                                <div>
                                    <div style="font-weight: 700;">156</div>
                                    <div style="font-size: 0.9rem; color: #666;">Meetings Booked</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SETTINGS MODULE -->
                <div id="settings" class="module">
                    <div class="module-header">
                        <h1>System Settings & Administration</h1>
                        <p>Configure your system, manage users, and control data</p>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <i class="fas fa-database"></i>
                            <div class="stat-number" id="studentsInDb">482</div>
                            <div class="stat-label">Students in Database</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <div class="stat-number" id="systemUsers">18</div>
                            <div class="stat-label">System Users</div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-hdd"></i>
                            <div class="stat-number">124 MB</div>
                            <div class="stat-label">Database Size</div>
                        </div>
                        <div class="stat-card up">
                            <i class="fas fa-shield-alt"></i>
                            <div class="stat-number">100%</div>
                            <div class="stat-label">System Secure</div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>School Information</h2>
                            <button class="btn btn-primary" onclick="editSchoolInfo()">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                            <div>
                                <div class="input-group">
                                    <label>School Name</label>
                                    <input type="text" id="schoolName" value="Harare High School" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>School Motto</label>
                                    <input type="text" id="schoolMotto" value="Strive for Excellence" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Address</label>
                                    <input type="text" id="schoolAddress" value="123 Learning Avenue, Harare, Zimbabwe" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                            </div>
                            
                            <div>
                                <div class="input-group">
                                    <label>Contact Phone</label>
                                    <input type="text" id="schoolPhone" value="+263 242 123456" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Email Address</label>
                                    <input type="email" id="schoolEmail" value="info@hararehigh.co.zw" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Academic Year</label>
                                    <input type="text" id="academicYear" value="2026" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Payment Settings</h2>
                            <button class="btn btn-primary" onclick="editPaymentSettings()">
                                <i class="fas fa-edit"></i> Edit Payment Details
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Mobile Money Accounts</h3>
                                <div class="input-group">
                                    <label>Ecocash Number (Default)</label>
                                    <div style="display: flex; gap: 10px;">
                                        <input type="text" id="ecocashNumber" value="0785 306 061" style="flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                        <button class="btn btn-secondary" onclick="changeEcocashNumber()">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="input-group">
                                    <label>OneMoney Number</label>
                                    <input type="text" value="0712 345 678" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Telecash Number</label>
                                    <input type="text" value="0733 987 654" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Bank Accounts</h3>
                                <div class="input-group">
                                    <label>Bank Name</label>
                                    <input type="text" value="CBZ Bank" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Account Name</label>
                                    <input type="text" value="Harare High School" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Account Number</label>
                                    <input type="text" value="456789123456" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                                
                                <div class="input-group">
                                    <label>Branch Code</label>
                                    <input type="text" value="Harare Main" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: var(--radius);" readonly>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                                <div>
                                    <strong>Note:</strong> These payment details are displayed to parents in the portal. Only administrators can change these settings.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>Data Management</h2>
                            <button class="btn btn-success" onclick="checkForUpdates()">
                                <i class="fas fa-sync-alt"></i> Check for Updates
                            </button>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px;">
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Backup & Restore</h3>
                                <p>Protect your school data with regular backups.</p>
                                
                                <div style="margin-top: 20px;">
                                    <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" onclick="backupDatabase()">
                                        <i class="fas fa-download"></i> Backup Database to USB
                                    </button>
                                    <button class="btn btn-secondary" style="width: 100%;" onclick="restoreDatabase()">
                                        <i class="fas fa-upload"></i> Restore from Backup
                                    </button>
                                </div>
                                
                                <div style="background: #f8f9fa; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                                        <div>
                                            <strong>Last Backup:</strong> Jan 15, 2026 17:30
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 style="color: var(--primary); margin-bottom: 15px;">Cloud Sync (Optional)</h3>
                                <p>Enable cloud synchronization for remote access and additional backup.</p>
                                
                                <div style="margin-top: 20px;">
                                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                                        <div>Cloud Sync Status</div>
                                        <div>
                                            <span class="tag tag-warning">Disabled</span>
                                        </div>
                                    </div>
                                    
                                    <button class="btn btn-secondary" style="width: 100%;" onclick="enableCloudSync()">
                                        <i class="fas fa-cloud"></i> Enable Cloud Sync
                                    </button>
                                    
                                    <div style="background: #f8f9fa; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                                        <div style="font-size: 0.9rem; color: #666;">
                                            <strong>Note:</strong> Cloud hosting requires annual renewal at minimal cost. Local installation has zero ongoing costs.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2>User Management</h2>
                            <button class="btn btn-success" onclick="openModal('add-user-modal')">
                                <i class="fas fa-user-plus"></i> Add New User
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Username</th>
                                        <th>Full Name</th>
                                        <th>Role</th>
                                        <th>Last Login</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- ===== SCREEN 4: QUOTE/PRICING ===== -->
    <div id="quote-screen" class="screen hidden">
        <div class="quote-container">
            <div class="quote-header">
                <h1>Ready to Own Your School's Future?</h1>
                <p>You've experienced the Complete School Engine. Now choose the package that's right for your school.</p>
            </div>
            
            <div class="pricing-grid">
                <div class="pricing-card">
                    <h3 class="pricing-title">The Digital Foundation</h3>
                    <p>Professional school website only</p>
                    <div class="pricing-price">$250<span> once-off</span></div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> Modern 5-Page Website</li>
                        <li><i class="fas fa-check"></i> Google Maps Integration</li>
                        <li><i class="fas fa-check"></i> Social Media Links</li>
                        <li><i class="fas fa-check"></i> Free .co.zw Domain (1st Year)</li>
                        <li><i class="fas fa-check"></i> You own the design 100%</li>
                        <li><i class="fas fa-times" style="color: #ccc;"></i> No Management System</li>
                    </ul>
                    <button class="btn btn-primary btn-quote" onclick="selectPackage('digital-foundation')">Select This Package</button>
                </div>
                
                <div class="pricing-card featured">
                    <div class="featured-badge">MOST POPULAR</div>
                    <h3 class="pricing-title">The Complete School Engine</h3>
                    <p>Everything your school needs in one bundle</p>
                    <div class="pricing-price">$550<span> once-off</span></div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> <strong>Lifetime License</strong> - No monthly fees</li>
                        <li><i class="fas fa-check"></i> All Management System Features</li>
                        <li><i class="fas fa-check"></i> Professional School Website</li>
                        <li><i class="fas fa-check"></i> <strong>Offline Mode</strong> - Works without internet</li>
                        <li><i class="fas fa-check"></i> Unlimited Students & Staff</li>
                        <li><i class="fas fa-check"></i> Free .co.zw Domain (1st Year)</li>
                        <li><i class="fas fa-check"></i> Parent Portal & SMS Module</li>
                        <li><i class="fas fa-check"></i> 1 Year Basic Support & Updates</li>
                    </ul>
                    <button class="btn btn-success btn-quote" style="background: var(--secondary); color: #000;" onclick="selectPackage('complete-engine')">Select This Package</button>
                </div>
                
                <div class="pricing-card">
                    <h3 class="pricing-title">The Professional System</h3>
                    <p>Management system only (no website)</p>
                    <div class="pricing-price">$400<span> once-off</span></div>
                    <ul class="pricing-features">
                        <li><i class="fas fa-check"></i> <strong>Lifetime License</strong> - No monthly fees</li>
                        <li><i class="fas fa-check"></i> All Management System Features</li>
                        <li><i class="fas fa-check"></i> <strong>Offline Mode</strong> - Works without internet</li>
                        <li><i class="fas fa-check"></i> Unlimited Students & Staff</li>
                        <li><i class="fas fa-check"></i> Parent Portal & SMS Module</li>
                        <li><i class="fas fa-check"></i> 1 Year Basic Support & Updates</li>
                        <li><i class="fas fa-times" style="color: #ccc;"></i> No Website Included</li>
                    </ul>
                    <button class="btn btn-primary btn-quote" onclick="selectPackage('professional-system')">Select This Package</button>
                </div>
            </div>
            
            <div style="background: #f0f7ff; padding: 30px; border-radius: 16px; margin-top: 40px;">
                <h2 style="color: var(--primary); text-align: center; margin-bottom: 20px;">The Lifetime Guarantee</h2>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; text-align: center;">
                    <div>
                        <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                            <i class="fas fa-ban"></i>
                        </div>
                        <h3>NO MONTHLY FEES</h3>
                        <p>Pay once, own forever</p>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                            <i class="fas fa-user-friends"></i>
                        </div>
                        <h3>NO PER-STUDENT FEES</h3>
                        <p>Unlimited students included</p>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 10px;">
                            <i class="fas fa-wifi-slash"></i>
                        </div>
                        <h3>OFFLINE CAPABILITY</h3>
                        <p>Works without internet</p>
                    </div>
                </div>
            </div>
            
            <div class="quote-actions">
                <button class="btn btn-success" style="padding: 18px 50px; font-size: 1.2rem;" onclick="contactTeamZero()">
                    <i class="fas fa-envelope"></i> CONTACT TEAM ZERO FOR YOUR QUOTE
                </button>
                <div style="margin-top: 25px;">
                    <button class="btn btn-secondary" onclick="showScreen('app-screen')">
                        <i class="fas fa-arrow-left"></i> Back to Demo
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ===== MODALS ===== -->
    
    <!-- PAYMENT RECEIPT MODAL -->
    <div id="receipt-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Payment Receipt</h2>
                <button class="close-modal" onclick="closeModal('receipt-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div style="font-size: 2.5rem; color: var(--success); margin-bottom: 15px;">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2 style="color: var(--success);">Payment Successful!</h2>
                </div>
                
                <div style="border: 2px solid #eee; border-radius: var(--radius); padding: 25px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div>
                            <strong id="receiptSchoolName">Harare High School</strong><br>
                            <span id="receiptSchoolAddress">123 Learning Avenue, Harare</span><br>
                            <span id="receiptSchoolPhone">+263 242 123456</span>
                        </div>
                        <div style="text-align: right;">
                            <strong>Official Receipt</strong><br>
                            <span id="receiptNumber">#RCP-2026-005</span><br>
                            Date: <span id="receiptDate">Jan 17, 2026</span>
                        </div>
                    </div>
                    
                    <div style="height: 1px; background: #eee; margin: 20px 0;"></div>
                    
                    <div style="margin-bottom: 20px;">
                        <table style="width: 100%;">
                            <tr>
                                <td><strong>Received from:</strong></td>
                                <td id="receiptFrom">Mr. P. Moyo</td>
                            </tr>
                            <tr>
                                <td><strong>Student:</strong></td>
                                <td id="receiptStudent">Tinotenda Moyo (Form 3B)</td>
                            </tr>
                            <tr>
                                <td><strong>Payment For:</strong></td>
                                <td id="receiptTerm">Term 1, 2026 School Fees</td>
                            </tr>
                            <tr>
                                <td><strong>Amount:</strong></td>
                                <td style="font-size: 1.5rem; font-weight: 700; color: var(--primary);" id="receiptAmount">$150.00</td>
                            </tr>
                            <tr>
                                <td><strong>Payment Method:</strong></td>
                                <td id="receiptMethod">Cash</td>
                            </tr>
                            <tr>
                                <td><strong>Reference:</strong></td>
                                <td id="receiptReference">-</td>
                            </tr>
                            <tr>
                                <td><strong>Received by:</strong></td>
                                <td id="receiptReceivedBy">Bursar (John Chikwanda)</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div style="height: 1px; background: #eee; margin: 20px 0;"></div>
                    
                    <div style="text-align: center; color: #666; font-style: italic;">
                        Thank you for your payment. This is an official receipt.
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn btn-primary" style="flex: 1;" onclick="printReceipt()">
                        <i class="fas fa-print"></i> Print Receipt
                    </button>
                    <button class="btn btn-success" style="flex: 1;" onclick="sendReceiptSMS()">
                        <i class="fas fa-sms"></i> Send SMS Copy
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('receipt-modal')">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- REPORT CARD MODAL -->
    <div id="report-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Term 1, 2026 Report Card</h2>
                <button class="close-modal" onclick="closeModal('report-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: white; padding: 40px; border: 1px solid #ddd; font-family: 'Times New Roman', Times, serif;">
                    <div style="text-align: center; border-bottom: 2px solid var(--primary); padding-bottom: 20px; margin-bottom: 30px;">
                        <h1 style="margin: 0; color: var(--primary);" id="reportSchoolName">HARARE HIGH SCHOOL</h1>
                        <p style="font-size: 1.2rem; margin: 10px 0;" id="reportSchoolMotto">Strive for Excellence</p>
                        <p id="reportSchoolContact">123 Learning Avenue, Harare, Zimbabwe | +263 242 123456</p>
                        <h2 id="reportTitle">TERM 1 2026 ACADEMIC REPORT</h2>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                        <div>
                            <strong>Name:</strong> <span id="report-student-name">Tinotenda Moyo</span><br>
                            <strong>Class:</strong> <span id="report-student-class">Form 3B</span><br>
                            <strong>Student ID:</strong> <span id="report-student-id">ST-2026-001</span>
                        </div>
                        <div>
                            <strong>Attendance:</strong> <span id="report-attendance">45/48 Days (93.8%)</span><br>
                            <strong>Term Position:</strong> <span id="report-position">4th out of 32</span><br>
                            <strong>Overall Average:</strong> <span id="report-average">74.7%</span>
                        </div>
                    </div>
                    
                    <table style="width: 100%; border: 1px solid #000; border-collapse: collapse; margin-bottom: 30px;">
                        <thead>
                            <tr style="background: #f0f0f0;">
                                <th style="border: 1px solid #000; padding: 10px;">Subject</th>
                                <th style="border: 1px solid #000; padding: 10px;">Mark (%)</th>
                                <th style="border: 1px solid #000; padding: 10px;">Grade</th>
                                <th style="border: 1px solid #000; padding: 10px;">Remark</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">Mathematics</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-math">78</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-math-grade">B</td>
                                <td style="border: 1px solid #000; padding: 10px;">Good</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">English Language</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-english">85</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-english-grade">A</td>
                                <td style="border: 1px solid #000; padding: 10px;">Excellent</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">Science</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-science">65</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-science-grade">C</td>
                                <td style="border: 1px solid #000; padding: 10px;">Satisfactory</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">History</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-history">72</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-history-grade">B</td>
                                <td style="border: 1px solid #000; padding: 10px;">Good</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">Shona</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-shona">88</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-shona-grade">A</td>
                                <td style="border: 1px solid #000; padding: 10px;">Excellent</td>
                            </tr>
                            <tr>
                                <td style="border: 1px solid #000; padding: 10px;">Geography</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-geography">60</td>
                                <td style="border: 1px solid #000; padding: 10px;" id="report-geography-grade">C</td>
                                <td style="border: 1px solid #000; padding: 10px;">Satisfactory</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div style="border: 1px solid #000; padding: 15px; margin-bottom: 30px;">
                        <strong>Class Teacher's Comment:</strong><br>
                        <em id="report-teacher-comment">A solid performance this term. Tinotenda has shown excellent improvement in Mathematics and English. Should focus more on Science practicals.</em>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 50px;">
                        <div style="text-align: center;">
                            _____________________<br>
                            <strong>P. Moyo</strong><br>
                            Class Teacher
                        </div>
                        <div style="text-align: center;">
                            _____________________<br>
                            <strong>School Stamp</strong><br>
                            Harare High School
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn btn-primary" style="flex: 1;" onclick="printReport()">
                        <i class="fas fa-print"></i> Print Report
                    </button>
                    <button class="btn btn-success" style="flex: 1;" onclick="saveReportPDF()">
                        <i class="fas fa-file-pdf"></i> Save as PDF
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('report-modal')">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- REGISTER STUDENT MODAL -->
    <div id="register-student-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Register New Student</h2>
                <button class="close-modal" onclick="closeModal('register-student-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="input-group">
                        <label>First Name *</label>
                        <input type="text" id="studentFirstName" placeholder="Enter first name">
                    </div>
                    <div class="input-group">
                        <label>Last Name *</label>
                        <input type="text" id="studentLastName" placeholder="Enter last name">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                    <div class="input-group">
                        <label>Date of Birth *</label>
                        <input type="date" id="studentDOB">
                    </div>
                    <div class="input-group">
                        <label>Gender *</label>
                        <select id="studentGender">
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Class *</label>
                    <select id="studentClass">
                        <option>Form 1A</option>
                        <option>Form 1B</option>
                        <option>Form 2A</option>
                        <option>Form 2B</option>
                        <option>Form 3A</option>
                        <option>Form 3B</option>
                        <option>Form 4A</option>
                        <option>Form 4B</option>
                        <option>Form 4C</option>
                    </select>
                </div>
                
                <div style="margin-top: 25px;">
                    <h3 style="color: var(--primary);">Guardian Information</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div class="input-group">
                            <label>Guardian Name *</label>
                            <input type="text" id="guardianName" placeholder="Full name">
                        </div>
                        <div class="input-group">
                            <label>Relationship *</label>
                            <select id="guardianRelationship">
                                <option>Father</option>
                                <option>Mother</option>
                                <option>Grandparent</option>
                                <option>Uncle/Aunt</option>
                                <option>Other</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div class="input-group">
                            <label>Phone Number *</label>
                            <input type="tel" id="guardianPhone" placeholder="07XX XXX XXX">
                        </div>
                        <div class="input-group">
                            <label>Email Address</label>
                            <input type="email" id="guardianEmail" placeholder="email@example.com">
                        </div>
                    </div>
                    
                    <div class="input-group" style="margin-top: 15px;">
                        <label>Payment Account (Ecocash/Bank)</label>
                        <input type="text" id="paymentAccount" placeholder="e.g., 0772 123 456 (Ecocash)">
                        <small style="color: #666;">This will be used for online payments from parent portal</small>
                    </div>
                </div>
                
                <div style="margin-top: 25px;">
                    <h3 style="color: var(--primary);">Initial Fee Payment</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                        <div class="input-group">
                            <label>Term *</label>
                            <select id="initialTerm">
                                <option>Term 1, 2026</option>
                                <option>Term 2, 2026</option>
                                <option>Term 3, 2026</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>Initial Payment Amount</label>
                            <input type="number" id="initialPayment" value="150.00">
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn btn-success" style="flex: 1;" onclick="registerStudent()">
                        <i class="fas fa-save"></i> Save & Register Student
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('register-student-modal')">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- CHANGE ECOCASH MODAL -->
    <div id="change-ecocash-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Change School Ecocash Number</h2>
                <button class="close-modal" onclick="closeModal('change-ecocash-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>Current Ecocash Number</label>
                    <input type="text" id="currentEcocash" value="0785 306 061" readonly style="background: #f8f9fa;">
                </div>
                
                <div class="input-group">
                    <label>New Ecocash Number</label>
                    <input type="text" id="newEcocash" placeholder="Enter new Ecocash number">
                </div>
                
                <div class="input-group">
                    <label>Confirm New Ecocash Number</label>
                    <input type="text" id="confirmEcocash" placeholder="Re-enter new Ecocash number">
                </div>
                
                <div class="input-group">
                    <label>Admin Password (Required)</label>
                    <input type="password" id="adminPassword" placeholder="Enter admin password">
                </div>
                
                <div style="background: #fff3cd; padding: 15px; border-radius: var(--radius); margin-top: 20px;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i>
                        <div>
                            <strong>Important:</strong> Changing the Ecocash number will affect all future online payments. Parents will see this new number in the parent portal.
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn btn-success" style="flex: 1;" onclick="updateEcocashNumber()">
                        <i class="fas fa-save"></i> Update Ecocash Number
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('change-ecocash-modal')">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ADD USER MODAL -->
    <div id="add-user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New System User</h2>
                <button class="close-modal" onclick="closeModal('add-user-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="input-group">
                        <label>First Name *</label>
                        <input type="text" id="userFirstName" placeholder="Enter first name">
                    </div>
                    <div class="input-group">
                        <label>Last Name *</label>
                        <input type="text" id="userLastName" placeholder="Enter last name">
                    </div>
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Username *</label>
                    <input type="text" id="userUsername" placeholder="Enter username">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                    <div class="input-group">
                        <label>Password *</label>
                        <input type="password" id="userPassword" placeholder="Enter password">
                    </div>
                    <div class="input-group">
                        <label>Confirm Password *</label>
                        <input type="password" id="userConfirmPassword" placeholder="Confirm password">
                    </div>
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Role *</label>
                    <select id="userRole">
                        <option value="Teacher">Teacher</option>
                        <option value="Bursar">Bursar</option>
                        <option value="Administrator">Administrator</option>
                        <option value="Headmaster">Headmaster</option>
                    </select>
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Email Address</label>
                    <input type="email" id="userEmail" placeholder="email@example.com">
                </div>
                
                <div class="input-group" style="margin-top: 15px;">
                    <label>Phone Number</label>
                    <input type="tel" id="userPhone" placeholder="07XX XXX XXX">
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button class="btn btn-success" style="flex: 1;" onclick="addSystemUser()">
                        <i class="fas fa-user-plus"></i> Add User
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeModal('add-user-modal')">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // ===== GLOBAL DATA =====
        let schoolData = {
            students: [],
            transactions: [],
            attendance: [],
            reports: [],
            users: [],
            settings: {
                ecocash: "0785 306 061",
                bankAccount: "456789123456",
                bankName: "CBZ Bank"
            },
            stats: {
                totalStudents: 482,
                feesCollected: 12450,
                outstandingFees: 3200,
                studentsWithBalance: 45,
                incomeThisMonth: 12450,
                expensesThisMonth: 8200,
                netProfit: 4250,
                outstandingReceivables: 3200
            }
        };

        // ===== TOAST NOTIFICATIONS =====
        function showToast(title, message, type = 'info') {
            const toastContainer = document.getElementById('toast-container');
            const toastId = 'toast-' + Date.now();
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.id = toastId;
            toast.innerHTML = `
                <div style="font-size: 1.5rem;">
                    ${type === 'success' ? 'âœ“' : type === 'error' ? 'âœ—' : 'â„¹'}
                </div>
                <div>
                    <strong>${title}</strong><br>
                    <small>${message}</small>
                </div>
                <button onclick="document.getElementById('${toastId}').remove()" style="background: none; border: none; cursor: pointer; color: #999;">Ã—</button>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, 300);
            }, 4000);
        }

        // ===== SCREEN MANAGEMENT =====
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
            
            if (screenId === 'app-screen') {
                initializeApp();
            }
        }
        
        function login() {
            showScreen('app-screen');
            showToast("Login Successful", "Welcome to Team Zero Complete School Engine!", "success");
            setTimeout(() => {
                showToast("Demo Instructions", "Use the sidebar to explore all features. All buttons are fully functional.", "info");
            }, 1000);
        }
        
        function logout() {
            if (confirm("Are you sure you want to logout?")) {
                showScreen('login-screen');
                showToast("Logged Out", "You have been successfully logged out.", "info");
            }
        }
        
        // ===== MODULE MANAGEMENT =====
        function showModule(moduleId) {
            document.querySelectorAll('.module').forEach(module => {
                module.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item').forEach(navItem => {
                navItem.classList.remove('active');
            });
            
            document.getElementById(moduleId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(navItem => {
                if (navItem.textContent.includes(getModuleName(moduleId))) {
                    navItem.classList.add('active');
                }
            });
            
            if (moduleId === 'reports') {
                updateReportStats();
                populateReportStudents();
            }
            
            if (moduleId === 'fees') {
                populatePaymentStudents();
                loadTransactions();
                updatePaymentStats();
            }
            
            if (moduleId === 'students') {
                loadStudents();
            }
            
            if (moduleId === 'attendance') {
                loadClassAttendance();
            }
            
            if (moduleId === 'finance') {
                loadDebtors();
                updateFinanceReport();
            }
            
            if (moduleId === 'communications') {
                updateRecipientCount();
                updateCharCount();
                loadCommunications();
            }
            
            if (moduleId === 'settings') {
                loadUsers();
            }
        }
        
        function getModuleName(moduleId) {
            const moduleNames = {
                'dashboard': 'Dashboard',
                'website': 'School Website',
                'students': 'Student Management',
                'fees': 'Fees & Payments',
                'attendance': 'Attendance',
                'reports': 'Academic Reports',
                'finance': 'Financial Management',
                'communications': 'Communications',
                'settings': 'System Settings'
            };
            return moduleNames[moduleId] || moduleId;
        }
        
        // ===== INITIALIZE APP =====
        function initializeApp() {
            // Initialize sample data
            initializeSampleData();
            
            // Load initial data
            loadStudents();
            loadTransactions();
            loadActivityLog();
            loadDebtors();
            loadUsers();
            
            // Update all stats
            updateAllStats();
            
            // Set current date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('paymentDate').value = today;
            
            // Set student DOB to a reasonable date
            const dob = new Date();
            dob.setFullYear(dob.getFullYear() - 14);
            document.getElementById('studentDOB').value = dob.toISOString().split('T')[0];
        }
        
        function initializeSampleData() {
            // Sample students
            schoolData.students = [
                {
                    id: 'ST-2026-001',
                    firstName: 'Tinotenda',
                    lastName: 'Moyo',
                    dob: '2008-08-15',
                    gender: 'Male',
                    class: 'Form 3B',
                    guardian: 'P. Moyo (Father)',
                    contact: '0772 123 456',
                    paymentAccount: '0772 123 456',
                    status: 'Active',
                    balance: 0
                },
                {
                    id: 'ST-2026-002',
                    firstName: 'Sarah',
                    lastName: 'Chikore',
                    dob: '2009-03-22',
                    gender: 'Female',
                    class: 'Form 1A',
                    guardian: 'G. Chikore (Mother)',
                    contact: '0712 987 654',
                    paymentAccount: '0712 987 654',
                    status: 'Active',
                    balance: 0
                },
                {
                    id: 'ST-2025-045',
                    firstName: 'Brian',
                    lastName: 'Dube',
                    dob: '2007-11-30',
                    gender: 'Male',
                    class: 'Form 4C',
                    guardian: 'Mrs. Dube (Mother)',
                    contact: '0773 456 789',
                    paymentAccount: '0773 456 789',
                    status: 'Active',
                    balance: 50
                },
                {
                    id: 'ST-2025-128',
                    firstName: 'Kudzanai',
                    lastName: 'Gara',
                    dob: '2008-06-14',
                    gender: 'Male',
                    class: 'Form 3B',
                    guardian: 'T. Gara (Father)',
                    contact: '0772 555 123',
                    paymentAccount: '0772 555 123',
                    status: 'Active',
                    balance: 150
                },
                {
                    id: 'ST-2026-003',
                    firstName: 'Tafadzwa',
                    lastName: 'Chipara',
                    dob: '2009-01-08',
                    gender: 'Male',
                    class: 'Form 2A',
                    guardian: 'Mr. Chipara (Father)',
                    contact: '0715 333 888',
                    paymentAccount: '0715 333 888',
                    status: 'Active',
                    balance: 0
                }
            ];
            
            // Sample transactions
            schoolData.transactions = [
                { id: 'RCP-2026-004', date: 'Today, 08:15', student: 'Tinotenda Moyo', amount: 150, method: 'Cash', term: 'Term 1, 2026', status: 'Completed' },
                { id: 'RCP-2026-003', date: 'Yesterday, 14:30', student: 'Sarah Chikore', amount: 300, method: 'Zipit', term: 'Term 1, 2026', status: 'Completed' },
                { id: 'RCP-2026-002', date: 'Jan 15, 10:22', student: 'Blessing Phiri', amount: 250, method: 'Ecocash', term: 'Term 1, 2026', status: 'Completed' },
                { id: 'RCP-2026-001', date: 'Jan 10, 09:15', student: 'Tariro Ndlovu', amount: 180, method: 'Bank Transfer', term: 'Term 1, 2026', status: 'Completed' }
            ];
            
            // Sample users
            schoolData.users = [
                { username: 'admin', name: 'System Administrator', role: 'Administrator', lastLogin: 'Today, 08:00', status: 'Active' },
                { username: 'bursar', name: 'John Chikwanda', role: 'Bursar', lastLogin: 'Today, 08:15', status: 'Active' },
                { username: 'teacher.moyo', name: 'Mr. P. Moyo', role: 'Teacher', lastLogin: 'Today, 08:10', status: 'Active' }
            ];
        }
        
        // ===== STUDENT MANAGEMENT =====
        function loadStudents() {
            const tbody = document.getElementById('studentTableBody');
            tbody.innerHTML = '';
            
            let filteredStudents = [...schoolData.students];
            
            // Apply search filter
            const searchTerm = document.getElementById('studentSearch').value.toLowerCase();
            if (searchTerm) {
                filteredStudents = filteredStudents.filter(student => 
                    student.firstName.toLowerCase().includes(searchTerm) ||
                    student.lastName.toLowerCase().includes(searchTerm) ||
                    student.id.toLowerCase().includes(searchTerm) ||
                    student.class.toLowerCase().includes(searchTerm) ||
                    student.guardian.toLowerCase().includes(searchTerm)
                );
            }
            
            // Apply class filter
            const classFilter = document.getElementById('classFilter').value;
            if (classFilter !== 'All Classes') {
                filteredStudents = filteredStudents.filter(student => 
                    student.class.includes(classFilter)
                );
            }
            
            // Apply status filter
            const statusFilter = document.getElementById('statusFilter').value;
            if (statusFilter !== 'All Status') {
                filteredStudents = filteredStudents.filter(student => 
                    student.status === statusFilter
                );
            }
            
            // Display students
            filteredStudents.forEach((student, index) => {
                const row = document.createElement('tr');
                const statusTag = student.balance > 0 ? 
                    (student.balance >= 100 ? 'tag-danger' : 'tag-warning') : 
                    'tag-success';
                const statusText = student.balance > 0 ? 
                    (student.balance >= 100 ? 'Overdue Fees' : 'Pending Fees') : 
                    'Active';
                
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>
                        <strong>${student.firstName} ${student.lastName}</strong><br>
                        <small>DOB: ${formatDate(student.dob)}</small>
                    </td>
                    <td>${student.class}</td>
                    <td>${student.guardian}</td>
                    <td>${student.contact}</td>
                    <td>${student.paymentAccount || '-'}</td>
                    <td><span class="tag ${statusTag}">${statusText}</span></td>
                    <td>
                        <button class="btn btn-primary" style="padding: 6px 12px; font-size: 0.9rem;" onclick="editStudent(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 0.9rem; margin-left: 5px;" onclick="viewStudent(${index})">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Update counters
            document.getElementById('studentCount').textContent = filteredStudents.length;
            document.getElementById('totalStudentCount').textContent = schoolData.students.length;
        }
        
        function searchStudents() {
            loadStudents();
        }
        
        function filterStudents() {
            loadStudents();
        }
        
        function previousPage() {
            showToast("Previous Page", "This would navigate to the previous page of results.", "info");
        }
        
        function nextPage() {
            showToast("Next Page", "This would navigate to the next page of results.", "info");
        }
        
        function registerStudent() {
            const firstName = document.getElementById('studentFirstName').value;
            const lastName = document.getElementById('studentLastName').value;
            const dob = document.getElementById('studentDOB').value;
            const gender = document.getElementById('studentGender').value;
            const studentClass = document.getElementById('studentClass').value;
            const guardianName = document.getElementById('guardianName').value;
            const guardianRelationship = document.getElementById('guardianRelationship').value;
            const guardianPhone = document.getElementById('guardianPhone').value;
            const guardianEmail = document.getElementById('guardianEmail').value;
            const paymentAccount = document.getElementById('paymentAccount').value;
            const initialTerm = document.getElementById('initialTerm').value;
            const initialPayment = parseFloat(document.getElementById('initialPayment').value) || 0;
            
            if (!firstName || !lastName || !dob || !guardianName || !guardianPhone) {
                showToast("Validation Error", "Please fill in all required fields (*)", "error");
                return;
            }
            
            // Generate student ID
            const year = new Date().getFullYear();
            const studentId = `ST-${year}-${(schoolData.students.length + 1).toString().padStart(3, '0')}`;
            
            // Create new student
            const newStudent = {
                id: studentId,
                firstName: firstName,
                lastName: lastName,
                dob: dob,
                gender: gender,
                class: studentClass,
                guardian: `${guardianName} (${guardianRelationship})`,
                contact: guardianPhone,
                email: guardianEmail,
                paymentAccount: paymentAccount,
                status: 'Active',
                balance: initialPayment > 0 ? 0 : 150 // Default fee if no initial payment
            };
            
            schoolData.students.push(newStudent);
            
            // Record initial payment if any
            if (initialPayment > 0) {
                const transaction = {
                    id: `RCP-${year}-${(schoolData.transactions.length + 1).toString().padStart(3, '0')}`,
                    date: 'Today, ' + new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    student: `${firstName} ${lastName}`,
                    amount: initialPayment,
                    method: 'Cash',
                    term: initialTerm,
                    status: 'Completed'
                };
                schoolData.transactions.push(transaction);
                
                // Update stats
                schoolData.stats.feesCollected += initialPayment;
                if (newStudent.balance === 0) {
                    schoolData.stats.studentsWithBalance = Math.max(0, schoolData.stats.studentsWithBalance - 1);
                }
            }
            
            // Update stats
            schoolData.stats.totalStudents = schoolData.students.length;
            
            // Close modal
            closeModal('register-student-modal');
            
            // Show success message
            showToast("Student Registered", `${firstName} ${lastName} has been successfully registered with ID: ${studentId}`, "success");
            
            // Reset form
            document.getElementById('studentFirstName').value = '';
            document.getElementById('studentLastName').value = '';
            document.getElementById('guardianName').value = '';
            document.getElementById('guardianPhone').value = '';
            document.getElementById('guardianEmail').value = '';
            document.getElementById('paymentAccount').value = '';
            
            // Reload students and update stats
            loadStudents();
            updateAllStats();
            populatePaymentStudents();
            populateReportStudents();
            
            // Add to activity log
            addActivityLog(`Added new student: ${firstName} ${lastName}`, `ID: ${studentId}, Class: ${studentClass}`);
        }
        
        function editStudent(index) {
            showToast("Edit Student", `This would open the edit form for ${schoolData.students[index].firstName} ${schoolData.students[index].lastName}`, "info");
        }
        
        function viewStudent(index) {
            const student = schoolData.students[index];
            showToast("View Student", `Viewing details for ${student.firstName} ${student.lastName}\nClass: ${student.class}\nGuardian: ${student.guardian}\nBalance: $${student.balance}`, "info");
        }
        
        function exportStudentList() {
            showToast("Export Successful", "Student list exported as CSV file. Download will start automatically.", "success");
            setTimeout(() => {
                showToast("File Ready", "students_list_2026.csv downloaded successfully.", "info");
            }, 500);
        }
        
        // ===== FEES & PAYMENTS =====
        function populatePaymentStudents() {
            const select = document.getElementById('paymentStudent');
            select.innerHTML = '<option value="">Select a student</option>';
            
            schoolData.students.forEach((student, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${student.firstName} ${student.lastName} (${student.id}) - ${student.class} - Balance: $${student.balance}`;
                select.appendChild(option);
            });
        }
        
        function updatePaymentInfo() {
            const select = document.getElementById('paymentStudent');
            const index = select.value;
            
            if (index !== "") {
                const student = schoolData.students[index];
                document.getElementById('paymentAmount').value = student.balance > 0 ? student.balance : 150;
                updatePaymentAmount();
            }
        }
        
        function updatePaymentAmount() {
            const amount = document.getElementById('paymentAmount').value;
            document.getElementById('ecocashAmount').textContent = parseFloat(amount).toFixed(2);
        }
        
        function showPaymentDetails() {
            const method = document.getElementById('paymentMethod').value;
            const detailsDiv = document.getElementById('ecocashDetails');
            const referenceLabel = document.getElementById('referenceLabel');
            const referenceInput = document.getElementById('paymentReference');
            
            if (method === 'Ecocash') {
                detailsDiv.style.display = 'block';
                referenceLabel.textContent = 'Ecocash Reference Number *';
                referenceInput.placeholder = 'e.g., ABC123XYZ';
                
                // Update reference in ecocash details
                const studentIndex = document.getElementById('paymentStudent').value;
                if (studentIndex !== "") {
                    const student = schoolData.students[studentIndex];
                    document.getElementById('ecocashReference').textContent = `${student.firstName} ${student.lastName.substring(0, 3)}`;
                }
            } else {
                detailsDiv.style.display = 'none';
                referenceLabel.textContent = 'Reference/Notes';
                referenceInput.placeholder = 'e.g., Bank transfer reference';
            }
            
            // Update school ecocash number
            document.getElementById('schoolEcocash').textContent = schoolData.settings.ecocash;
        }
        
        function processPayment() {
            const studentIndex = document.getElementById('paymentStudent').value;
            const amount = parseFloat(document.getElementById('paymentAmount').value);
            const method = document.getElementById('paymentMethod').value;
            const term = document.getElementById('paymentTerm').value;
            const date = document.getElementById('paymentDate').value;
            const reference = document.getElementById('paymentReference').value;
            
            if (studentIndex === "") {
                showToast("Validation Error", "Please select a student", "error");
                return;
            }
            
            if (!amount || amount <= 0) {
                showToast("Validation Error", "Please enter a valid payment amount", "error");
                return;
            }
            
            if (method === 'Ecocash' && !reference) {
                showToast("Validation Error", "Please enter Ecocash reference number", "error");
                return;
            }
            
            const student = schoolData.students[studentIndex];
            const year = new Date().getFullYear();
            
            // Create transaction
            const transaction = {
                id: `RCP-${year}-${(schoolData.transactions.length + 1).toString().padStart(3, '0')}`,
                date: 'Today, ' + new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                student: `${student.firstName} ${student.lastName}`,
                amount: amount,
                method: method,
                term: term,
                status: 'Completed',
                reference: reference
            };
            
            // Add transaction
            schoolData.transactions.push(transaction);
            
            // Update student balance
            student.balance = Math.max(0, student.balance - amount);
            if (student.balance === 0) {
                schoolData.stats.studentsWithBalance = Math.max(0, schoolData.stats.studentsWithBalance - 1);
            }
            
            // Update stats
            schoolData.stats.feesCollected += amount;
            schoolData.stats.outstandingFees = Math.max(0, schoolData.stats.outstandingFees - amount);
            schoolData.stats.outstandingReceivables = Math.max(0, schoolData.stats.outstandingReceivables - amount);
            schoolData.stats.incomeThisMonth += amount;
            schoolData.stats.netProfit = schoolData.stats.incomeThisMonth - schoolData.stats.expensesThisMonth;
            
            // Update collection rate
            const totalFees = schoolData.students.length * 150; // Assuming $150 per student
            schoolData.stats.collectionRate = Math.round((schoolData.stats.feesCollected / totalFees) * 100);
            
            // Show receipt
            showReceipt(transaction, student);
            
            // Update UI
            loadTransactions();
            updateAllStats();
            populatePaymentStudents();
            loadDebtors();
            
            // Add to activity log
            addActivityLog(`Recorded payment: $${amount}`, `${student.firstName} ${student.lastName}, ${method}`);
        }
        
        function showReceipt(transaction, student) {
            // Populate receipt data
            document.getElementById('receiptNumber').textContent = transaction.id;
            document.getElementById('receiptDate').textContent = formatDate(new Date().toISOString().split('T')[0]);
            document.getElementById('receiptFrom').textContent = student.guardian.split('(')[0].trim();
            document.getElementById('receiptStudent').textContent = `${student.firstName} ${student.lastName} (${student.class})`;
            document.getElementById('receiptTerm').textContent = transaction.term;
            document.getElementById('receiptAmount').textContent = `$${transaction.amount.toFixed(2)}`;
            document.getElementById('receiptMethod').textContent = transaction.method;
            document.getElementById('receiptReference').textContent = transaction.reference || '-';
            
            // Open modal
            openModal('receipt-modal');
        }
        
        function printReceipt() {
            showToast("Print Receipt", "Receipt sent to printer. A physical copy will be printed.", "success");
        }
        
        function sendReceiptSMS() {
            showToast("SMS Sent", "Receipt copy sent to parent's mobile phone via SMS.", "success");
        }
        
        function loadTransactions() {
            const tbody = document.getElementById('transactionTableBody');
            tbody.innerHTML = '';
            
            const filter = document.getElementById('transactionFilter').value;
            let filteredTransactions = [...schoolData.transactions];
            
            // Apply filter (simplified)
            if (filter === 'This Month') {
                filteredTransactions = filteredTransactions.slice(0, 3);
            } else if (filter === 'Last Month') {
                filteredTransactions = filteredTransactions.slice(3);
            }
            
            filteredTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${transaction.id}</td>
                    <td>${transaction.date}</td>
                    <td>${transaction.student}</td>
                    <td style="font-weight: 700;">$${transaction.amount.toFixed(2)}</td>
                    <td>${transaction.method}</td>
                    <td>${transaction.term}</td>
                    <td><span class="tag tag-success">${transaction.status}</span></td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function filterTransactions() {
            loadTransactions();
        }
        
        function exportTransactions() {
            showToast("Export Successful", "Transaction history exported as Excel file.", "success");
        }
        
        function viewAllTransactions() {
            showToast("All Transactions", "This would show the complete transaction history in a new view.", "info");
        }
        
        // ===== ATTENDANCE =====
        function loadClassAttendance() {
            const tbody = document.getElementById('attendanceTableBody');
            tbody.innerHTML = '';
            
            const selectedClass = document.getElementById('attendanceClass').value;
            const selectedDate = document.getElementById('attendanceDate').value;
            
            // Filter students by class
            const classStudents = schoolData.students.filter(student => student.class === selectedClass);
            
            // Generate attendance rows
            classStudents.forEach((student, index) => {
                const row = document.createElement('tr');
                const studentId = `attendance-${index}`;
                
                row.innerHTML = `
                    <td>${student.firstName} ${student.lastName}</td>
                    <td style="text-align: center;">
                        <input type="radio" name="${studentId}" value="present" checked>
                    </td>
                    <td style="text-align: center;">
                        <input type="radio" name="${studentId}" value="absent">
                    </td>
                    <td style="text-align: center;">
                        <input type="radio" name="${studentId}" value="late">
                    </td>
                    <td>
                        <input type="text" class="absence-reason" placeholder="Reason" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Update summary
            updateAttendanceSummary();
        }
        
        function updateAttendanceSummary() {
            const rows = document.querySelectorAll('#attendanceTableBody tr');
            let presentCount = 0;
            let absentCount = 0;
            let lateCount = 0;
            
            rows.forEach(row => {
                const presentRadio = row.querySelector('input[value="present"]');
                const absentRadio = row.querySelector('input[value="absent"]');
                const lateRadio = row.querySelector('input[value="late"]');
                
                if (presentRadio && presentRadio.checked) presentCount++;
                if (absentRadio && absentRadio.checked) absentCount++;
                if (lateRadio && lateRadio.checked) lateCount++;
            });
            
            const total = presentCount + absentCount + lateCount;
            const attendanceRate = total > 0 ? ((presentCount + lateCount * 0.5) / total * 100).toFixed(1) : 0;
            
            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('absentCount').textContent = absentCount;
            document.getElementById('lateCount').textContent = lateCount;
            document.getElementById('attendanceRate').textContent = attendanceRate;
            
            // Update weekly and monthly attendance (simplified)
            document.getElementById('weeklyAttendance').textContent = `${(95 + Math.random() * 3).toFixed(1)}%`;
            document.getElementById('monthlyAttendance').textContent = `${(94 + Math.random() * 4).toFixed(1)}%`;
            
            // Update attendance summary
            const summaryDiv = document.getElementById('attendanceSummary');
            const classes = ['Form 1A', 'Form 2A', 'Form 3B', 'Form 4C'];
            summaryDiv.innerHTML = '';
            
            classes.forEach(cls => {
                const rate = (95 + Math.random() * 5).toFixed(1);
                const div = document.createElement('div');
                div.style.display = 'flex';
                div.style.justifyContent = 'space-between';
                div.style.marginBottom = '10px';
                div.innerHTML = `
                    <div>${cls}</div>
                    <div><strong>${rate}%</strong> ${rate < 96 ? '(Needs Attention)' : ''}</div>
                `;
                summaryDiv.appendChild(div);
            });
        }
        
        function saveAttendance() {
            const selectedClass = document.getElementById('attendanceClass').value;
            const selectedDate = document.getElementById('attendanceDate').value;
            
            showToast("Attendance Saved", `Attendance for ${selectedClass} on ${formatDate(selectedDate)} has been saved successfully.`, "success");
            
            // Add to activity log
            addActivityLog(`Marked attendance for ${selectedClass}`, `Date: ${formatDate(selectedDate)}`);
        }
        
        function generateAttendanceReport() {
            showToast("Report Generated", "Monthly attendance report generated and sent to printer.", "success");
        }
        
        // ===== REPORTS =====
        function populateReportStudents() {
            const select = document.getElementById('reportStudent');
            select.innerHTML = '<option value="">Select a student</option>';
            
            schoolData.students.forEach((student, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${student.firstName} ${student.lastName} (${student.class})`;
                select.appendChild(option);
            });
        }
        
        function loadStudentMarks() {
            const index = document.getElementById('reportStudent').value;
            if (index !== "") {
                // Load student's existing marks or use defaults
                document.getElementById('mathMark').value = 78;
                document.getElementById('englishMark').value = 85;
                document.getElementById('scienceMark').value = 65;
                document.getElementById('historyMark').value = 72;
                document.getElementById('shonaMark').value = 88;
                document.getElementById('geographyMark').value = 60;
                updateReportStats();
            }
        }
        
        function updateReportStats() {
            // Get all mark values
            const math = parseInt(document.getElementById('mathMark').value) || 0;
            const english = parseInt(document.getElementById('englishMark').value) || 0;
            const science = parseInt(document.getElementById('scienceMark').value) || 0;
            const history = parseInt(document.getElementById('historyMark').value) || 0;
            const shona = parseInt(document.getElementById('shonaMark').value) || 0;
            const geography = parseInt(document.getElementById('geographyMark').value) || 0;
            
            // Calculate average
            const average = (math + english + science + history + shona + geography) / 6;
            
            // Update display
            document.getElementById('averageScore').textContent = average.toFixed(1) + '%';
            
            // Determine grade
            let grade = 'F';
            let gradeColor = '#dc3545';
            if (average >= 80) {
                grade = 'A';
                gradeColor = '#28a745';
            } else if (average >= 70) {
                grade = 'B';
                gradeColor = '#17a2b8';
            } else if (average >= 60) {
                grade = 'C';
                gradeColor = '#ffc107';
            } else if (average >= 50) {
                grade = 'D';
                gradeColor = '#fd7e14';
            } else if (average >= 40) {
                grade = 'E';
                gradeColor = '#fd7e14';
            }
            
            document.getElementById('gradeLetter').textContent = grade;
            document.getElementById('gradeLetter').style.color = gradeColor;
        }
        
        function generateReportCard() {
            const index = document.getElementById('reportStudent').value;
            const term = document.getElementById('reportTerm').value;
            
            if (index === "") {
                showToast("Validation Error", "Please select a student", "error");
                return;
            }
            
            const student = schoolData.students[index];
            
            // Get marks
            const math = parseInt(document.getElementById('mathMark').value) || 0;
            const english = parseInt(document.getElementById('englishMark').value) || 0;
            const science = parseInt(document.getElementById('scienceMark').value) || 0;
            const history = parseInt(document.getElementById('historyMark').value) || 0;
            const shona = parseInt(document.getElementById('shonaMark').value) || 0;
            const geography = parseInt(document.getElementById('geographyMark').value) || 0;
            const comment = document.getElementById('teacherComment').value;
            
            // Calculate average
            const average = (math + english + science + history + shona + geography) / 6;
            
            // Determine grades
            const getGrade = (score) => {
                if (score >= 80) return 'A';
                if (score >= 70) return 'B';
                if (score >= 60) return 'C';
                if (score >= 50) return 'D';
                if (score >= 40) return 'E';
                return 'F';
            };
            
            // Populate report modal
            document.getElementById('report-student-name').textContent = `${student.firstName} ${student.lastName}`;
            document.getElementById('report-student-class').textContent = student.class;
            document.getElementById('report-student-id').textContent = student.id;
            document.getElementById('report-attendance').textContent = '45/48 Days (93.8%)';
            document.getElementById('report-position').textContent = '4th out of 32';
            document.getElementById('report-average').textContent = average.toFixed(1) + '%';
            
            document.getElementById('report-math').textContent = math;
            document.getElementById('report-math-grade').textContent = getGrade(math);
            document.getElementById('report-english').textContent = english;
            document.getElementById('report-english-grade').textContent = getGrade(english);
            document.getElementById('report-science').textContent = science;
            document.getElementById('report-science-grade').textContent = getGrade(science);
            document.getElementById('report-history').textContent = history;
            document.getElementById('report-history-grade').textContent = getGrade(history);
            document.getElementById('report-shona').textContent = shona;
            document.getElementById('report-shona-grade').textContent = getGrade(shona);
            document.getElementById('report-geography').textContent = geography;
            document.getElementById('report-geography-grade').textContent = getGrade(geography);
            document.getElementById('report-teacher-comment').textContent = comment;
            
            // Open modal
            openModal('report-modal');
            
            // Add to activity log
            addActivityLog(`Generated report for ${student.firstName} ${student.lastName}`, `Term: ${term}, Average: ${average.toFixed(1)}%`);
        }
        
        function printReport() {
            showToast("Report Printed", "Report card sent to printer. A physical copy will be printed.", "success");
        }
        
        function saveReportPDF() {
            showToast("PDF Saved", "Report card saved as PDF file. Download will start automatically.", "success");
        }
        
        function bulkPrintReports() {
            showToast("Bulk Print", "All term reports are being sent to the printer.", "info");
        }
        
        function addReportTemplate() {
            showToast("New Template", "This would open the template creation wizard.", "info");
        }
        
        function previewTemplate(type) {
            const templates = {
                'standard': 'Standard Term Report Template',
                'progress': 'Progress Report Template',
                'merit': 'Merit Certificate Template'
            };
            showToast("Template Preview", `Previewing ${templates[type]}`, "info");
        }
        
        // ===== FINANCIAL MANAGEMENT =====
        function loadDebtors() {
            const tbody = document.getElementById('debtorsTableBody');
            tbody.innerHTML = '';
            
            const debtors = schoolData.students.filter(student => student.balance > 0);
            
            debtors.forEach((student, index) => {
                const dueDate = new Date();
                dueDate.setDate(dueDate.getDate() - Math.floor(Math.random() * 30));
                const lastReminder = new Date();
                lastReminder.setDate(lastReminder.getDate() - Math.floor(Math.random() * 10));
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.firstName} ${student.lastName}</td>
                    <td>${student.class}</td>
                    <td style="color: var(--danger); font-weight: 700;">$${student.balance.toFixed(2)}</td>
                    <td>${formatDate(dueDate.toISOString().split('T')[0])}</td>
                    <td>${student.contact}</td>
                    <td>${student.paymentAccount || '-'}</td>
                    <td>${formatDate(lastReminder.toISOString().split('T')[0])}</td>
                    <td>
                        <button class="btn btn-primary" style="padding: 6px 12px; font-size: 0.9rem;" onclick="callParent(${index})">
                            <i class="fas fa-phone"></i>
                        </button>
                        <button class="btn btn-success" style="padding: 6px 12px; font-size: 0.9rem; margin-left: 5px;" onclick="sendSMSReminder(${index})">
                            <i class="fas fa-sms"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function callParent(index) {
            const student = schoolData.students[index];
            showToast("Calling Parent", `Calling ${student.guardian} at ${student.contact}...`, "info");
        }
        
        function sendSMSReminder(index) {
            const student = schoolData.students[index];
            showToast("SMS Reminder Sent", `Fee reminder sent to ${student.guardian} at ${student.contact}`, "success");
        }
        
        function sendDebtReminders() {
            const debtors = schoolData.students.filter(student => student.balance > 0);
            showToast("Bulk Reminders Sent", `Fee reminders sent to ${debtors.length} parents via SMS.`, "success");
        }
        
        function updateFinanceReport() {
            const period = document.getElementById('financePeriod').value;
            
            // Update income breakdown
            const incomeBreakdown = document.getElementById('incomeBreakdown');
            incomeBreakdown.innerHTML = `
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>School Fees</div>
                    <div style="font-weight: 700;">$${schoolData.stats.feesCollected.toFixed(2)}</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Other Income</div>
                    <div style="font-weight: 700;">$850.00</div>
                </div>
                <div style="height: 2px; background: #eee; margin: 15px 0;"></div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div><strong>Total Income</strong></div>
                    <div style="font-weight: 700; color: var(--success);">$${(schoolData.stats.feesCollected + 850).toFixed(2)}</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Staff Salaries</div>
                    <div style="font-weight: 700;">$5,800.00</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Utilities & Maintenance</div>
                    <div style="font-weight: 700;">$1,200.00</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Teaching Materials</div>
                    <div style="font-weight: 700;">$750.00</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Other Expenses</div>
                    <div style="font-weight: 700;">$450.00</div>
                </div>
                <div style="height: 2px; background: #eee; margin: 15px 0;"></div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div><strong>Total Expenses</strong></div>
                    <div style="font-weight: 700; color: var(--danger);">$${schoolData.stats.expensesThisMonth.toFixed(2)}</div>
                </div>
                <div style="height: 2px; background: #eee; margin: 15px 0;"></div>
                <div style="display: flex; justify-content: space-between;">
                    <div><strong>Net Profit/Loss</strong></div>
                    <div style="font-weight: 700; color: var(--success);">$${schoolData.stats.netProfit.toFixed(2)}</div>
                </div>
            `;
            
            // Update stats
            document.getElementById('incomeThisMonth').textContent = `$${schoolData.stats.incomeThisMonth.toFixed(2)}`;
            document.getElementById('expensesThisMonth').textContent = `$${schoolData.stats.expensesThisMonth.toFixed(2)}`;
            document.getElementById('netProfit').textContent = `$${schoolData.stats.netProfit.toFixed(2)}`;
            document.getElementById('outstandingReceivables').textContent = `$${schoolData.stats.outstandingReceivables.toFixed(2)}`;
        }
        
        function showFinanceChart() {
            showToast("Finance Chart", "Opening detailed income vs expense chart visualization.", "info");
        }
        
        // ===== COMMUNICATIONS =====
        function updateRecipientCount() {
            const allParents = document.getElementById('allParents').checked;
            const form3Parents = document.getElementById('form3Parents').checked;
            const feeBalanceParents = document.getElementById('feeBalanceParents').checked;
            const customList = document.getElementById('customList').checked;
            
            let count = 0;
            
            if (allParents) {
                count = schoolData.stats.totalStudents;
            } else if (form3Parents) {
                count = schoolData.students.filter(s => s.class.includes('Form 3')).length;
            } else if (feeBalanceParents) {
                count = schoolData.stats.studentsWithBalance;
            } else if (customList) {
                count = 50; // Example custom list size
            }
            
            document.getElementById('recipientCount').textContent = count;
        }
        
        function updateCharCount() {
            const message = document.getElementById('smsMessage').value;
            const charCount = message.length;
            const smsCount = Math.ceil(charCount / 160);
            
            document.getElementById('charCount').textContent = charCount;
            document.getElementById('smsCount').textContent = smsCount;
            
            // Update SMS credits
            const credits = 247 - smsCount;
            document.getElementById('smsCredits').textContent = Math.max(0, credits);
        }
        
        function sendSMSAnnouncement() {
            const message = document.getElementById('smsMessage').value;
            const recipientCount = parseInt(document.getElementById('recipientCount').textContent);
            
            if (!message.trim()) {
                showToast("Validation Error", "Please enter a message", "error");
                return;
            }
            
            if (recipientCount === 0) {
                showToast("Validation Error", "Please select recipients", "error");
                return;
            }
            
            // Deduct SMS credits
            const smsCount = Math.ceil(message.length / 160);
            const currentCredits = parseInt(document.getElementById('smsCredits').textContent);
            const newCredits = Math.max(0, currentCredits - smsCount);
            document.getElementById('smsCredits').textContent = newCredits;
            
            showToast("SMS Sent", `Message sent to ${recipientCount} parents successfully.`, "success");
            
            // Add to communications list
            const commList = document.getElementById('communicationsList');
            const commDiv = document.createElement('div');
            commDiv.style.padding = '15px';
            commDiv.style.borderBottom = '1px solid #eee';
            commDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between;">
                    <div>
                        <strong>Announcement Sent</strong>
                        <div style="color: #666; font-size: 0.9rem;">${new Date().toLocaleDateString()} â€¢ ${recipientCount} recipients</div>
                    </div>
                    <div>
                        <span class="tag tag-success">Delivered</span>
                    </div>
                </div>
                <div style="margin-top: 10px; color: #666; font-style: italic;">"${message.substring(0, 100)}${message.length > 100 ? '...' : ''}"</div>
            `;
            commList.insertBefore(commDiv, commList.firstChild);
            
            // Add to activity log
            addActivityLog(`Sent SMS announcement`, `Recipients: ${recipientCount}, Message: ${message.substring(0, 50)}...`);
        }
        
        function loadCommunications() {
            const commList = document.getElementById('communicationsList');
            commList.innerHTML = `
                <div style="padding: 15px; border-bottom: 1px solid #eee; background: #f8f9fa;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <strong>Fee Reminders</strong>
                            <div style="color: #666; font-size: 0.9rem;">Jan 15, 2026 â€¢ 45 recipients</div>
                        </div>
                        <div>
                            <span class="tag tag-success">Delivered</span>
                        </div>
                    </div>
                </div>
                <div style="padding: 15px; border-bottom: 1px solid #eee;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <strong>Term Begins Announcement</strong>
                            <div style="color: #666; font-size: 0.9rem;">Jan 8, 2026 â€¢ 482 recipients</div>
                        </div>
                        <div>
                            <span class="tag tag-success">Delivered</span>
                        </div>
                    </div>
                </div>
                <div style="padding: 15px;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <strong>Holiday Greetings</strong>
                            <div style="color: #666; font-size: 0.9rem;">Dec 20, 2025 â€¢ 482 recipients</div>
                        </div>
                        <div>
                            <span class="tag tag-success">Delivered</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function viewCommunicationHistory() {
            showToast("Communication History", "Opening complete communication history log.", "info");
        }
        
        function openParentPortal() {
            showToast("Parent Portal", "Opening parent portal in a new window. Parents can login to view student information and make payments.", "info");
        }
        
        // ===== SETTINGS =====
        function editSchoolInfo() {
            // Toggle edit mode
            const inputs = ['schoolName', 'schoolMotto', 'schoolAddress', 'schoolPhone', 'schoolEmail', 'academicYear'];
            const isReadOnly = document.getElementById('schoolName').readOnly;
            
            inputs.forEach(id => {
                const input = document.getElementById(id);
                input.readOnly = !isReadOnly;
                input.style.background = isReadOnly ? 'white' : '#f8f9fa';
                input.style.border = isReadOnly ? '1px solid #ddd' : '1px solid var(--primary)';
            });
            
            const button = document.querySelector('#settings .card .btn-primary');
            if (isReadOnly) {
                button.innerHTML = '<i class="fas fa-save"></i> Save';
                button.onclick = saveSchoolInfo;
            } else {
                button.innerHTML = '<i class="fas fa-edit"></i> Edit';
                button.onclick = editSchoolInfo;
            }
        }
        
        function saveSchoolInfo() {
            showToast("School Info Saved", "School information updated successfully.", "success");
            editSchoolInfo(); // Switch back to view mode
        }
        
        function editPaymentSettings() {
            showToast("Edit Payment Settings", "This would open the payment settings editor.", "info");
        }
        
        function changeEcocashNumber() {
            openModal('change-ecocash-modal');
        }
        
        function updateEcocashNumber() {
            const newNumber = document.getElementById('newEcocash').value;
            const confirmNumber = document.getElementById('confirmEcocash').value;
            const password = document.getElementById('adminPassword').value;
            
            if (!newNumber || !confirmNumber || !password) {
                showToast("Validation Error", "Please fill in all fields", "error");
                return;
            }
            
            if (newNumber !== confirmNumber) {
                showToast("Validation Error", "Ecocash numbers do not match", "error");
                return;
            }
            
            if (password !== 'admin') {
                showToast("Validation Error", "Incorrect admin password", "error");
                return;
            }
            
            // Update ecocash number
            schoolData.settings.ecocash = newNumber;
            
            // Update UI
            document.getElementById('ecocashNumber').value = newNumber;
            document.getElementById('currentEcocash').value = newNumber;
            document.getElementById('schoolEcocash').textContent = newNumber;
            
            // Close modal
            closeModal('change-ecocash-modal');
            
            // Show success message
            showToast("Ecocash Updated", `School Ecocash number updated to ${newNumber}. Parents will see this new number in the portal.`, "success");
            
            // Add to activity log
            addActivityLog(`Updated school Ecocash number`, `New number: ${newNumber}`);
        }
        
        function backupDatabase() {
            showToast("Backup Started", "Database backup to USB drive in progress...", "info");
            setTimeout(() => {
                showToast("Backup Complete", "Database successfully backed up to USB drive.", "success");
            }, 2000);
        }
        
        function restoreDatabase() {
            showToast("Restore Database", "This would open the database restore wizard.", "info");
        }
        
        function checkForUpdates() {
            showToast("Checking Updates", "Checking for system updates...", "info");
            setTimeout(() => {
                showToast("System Up to Date", "Your system is running the latest version (v2.6.1).", "success");
            }, 1500);
        }
        
        function enableCloudSync() {
            showToast("Cloud Sync", "This would enable cloud synchronization for remote access.", "info");
        }
        
        function loadUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            schoolData.users.forEach((user, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.name}</td>
                    <td><span class="tag tag-info">${user.role}</span></td>
                    <td>${user.lastLogin}</td>
                    <td><span class="tag tag-success">${user.status}</span></td>
                    <td>
                        <button class="btn btn-primary" style="padding: 6px 12px; font-size: 0.9rem;" onclick="editUser(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Update user count
            document.getElementById('systemUsers').textContent = schoolData.users.length;
            document.getElementById('studentsInDb').textContent = schoolData.stats.totalStudents;
        }
        
        function editUser(index) {
            const user = schoolData.users[index];
            showToast("Edit User", `Editing user: ${user.name} (${user.role})`, "info");
        }
        
        function addSystemUser() {
            const firstName = document.getElementById('userFirstName').value;
            const lastName = document.getElementById('userLastName').value;
            const username = document.getElementById('userUsername').value;
            const password = document.getElementById('userPassword').value;
            const confirmPassword = document.getElementById('userConfirmPassword').value;
            const role = document.getElementById('userRole').value;
            const email = document.getElementById('userEmail').value;
            const phone = document.getElementById('userPhone').value;
            
            if (!firstName || !lastName || !username || !password || !confirmPassword || !role) {
                showToast("Validation Error", "Please fill in all required fields (*)", "error");
                return;
            }
            
            if (password !== confirmPassword) {
                showToast("Validation Error", "Passwords do not match", "error");
                return;
            }
            
            // Create new user
            const newUser = {
                username: username,
                name: `${firstName} ${lastName}`,
                role: role,
                lastLogin: 'Never',
                status: 'Active',
                email: email,
                phone: phone
            };
            
            schoolData.users.push(newUser);
            
            // Close modal
            closeModal('add-user-modal');
            
            // Show success message
            showToast("User Added", `${firstName} ${lastName} has been added as a ${role}.`, "success");
            
            // Reset form
            document.getElementById('userFirstName').value = '';
            document.getElementById('userLastName').value = '';
            document.getElementById('userUsername').value = '';
            document.getElementById('userPassword').value = '';
            document.getElementById('userConfirmPassword').value = '';
            document.getElementById('userEmail').value = '';
            document.getElementById('userPhone').value = '';
            
            // Reload users
            loadUsers();
            
            // Add to activity log
            addActivityLog(`Added new system user`, `${firstName} ${lastName} as ${role}`);
        }
        
        // ===== QUOTE/PRICING =====
        function selectPackage(packageType) {
            const packages = {
                'digital-foundation': 'The Digital Foundation ($250)',
                'complete-engine': 'The Complete School Engine ($550)',
                'professional-system': 'The Professional System ($400)'
            };
            
            showToast("Package Selected", `You have selected: ${packages[packageType]}. A Team Zero representative will contact you.`, "success");
        }
        
        function contactTeamZero() {
            showToast("Contact Team Zero", "ðŸ“§ Email: fariechitodha@gmail.com\nðŸ“ž Phone: 0785 306 061\nðŸ“ Location: Zimbabwe\n\nA representative will contact you within 24 hours.", "info");
        }
        
        // ===== UTILITY FUNCTIONS =====
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });
        }
        
        function updateAllStats() {
            // Update dashboard stats
            document.getElementById('totalStudents').textContent = schoolData.stats.totalStudents;
            document.getElementById('feesCollected').textContent = `$${schoolData.stats.feesCollected.toFixed(2)}`;
            document.getElementById('outstandingFees').textContent = `$${schoolData.stats.outstandingFees.toFixed(2)}`;
            document.getElementById('studentsWithBalance').textContent = schoolData.stats.studentsWithBalance;
            
            // Update fees module stats
            document.getElementById('feesCollectedModule').textContent = `$${schoolData.stats.feesCollected.toFixed(2)}`;
            document.getElementById('outstandingFeesModule').textContent = `$${schoolData.stats.outstandingFees.toFixed(2)}`;
            document.getElementById('collectionRate').textContent = `${schoolData.stats.collectionRate}%`;
            document.getElementById('studentsWithBalanceModule').textContent = schoolData.stats.studentsWithBalance;
        }
        
        function addActivityLog(action, details) {
            const tbody = document.getElementById('activityLog');
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${timeString}</td>
                <td><span class="tag tag-info">System</span></td>
                <td>${action}</td>
                <td>${details}</td>
            `;
            
            // Add to top
            if (tbody.firstChild) {
                tbody.insertBefore(row, tbody.firstChild);
            } else {
                tbody.appendChild(row);
            }
            
            // Keep only last 5 entries
            while (tbody.children.length > 5) {
                tbody.removeChild(tbody.lastChild);
            }
        }
        
        function loadActivityLog() {
            const tbody = document.getElementById('activityLog');
            tbody.innerHTML = `
                <tr>
                    <td>08:15 AM</td>
                    <td><span class="tag tag-info">Bursar</span></td>
                    <td>Receipt #2026-004 generated</td>
                    <td>$150.00 â€¢ Tinotenda Moyo</td>
                </tr>
                <tr>
                    <td>08:10 AM</td>
                    <td><span class="tag tag-info">Mr. Moyo</span></td>
                    <td>Marked Form 3B Attendance</td>
                    <td>45/48 present â€¢ 3 absent with notes</td>
                </tr>
                <tr>
                    <td>08:05 AM</td>
                    <td><span class="tag tag-info">Admin</span></td>
                    <td>Added new student</td>
                    <td>T. Chipara â€¢ Form 2A</td>
                </tr>
                <tr>
                    <td>Yesterday</td>
                    <td><span class="tag tag-info">System</span></td>
                    <td>Automated SMS reminders sent</td>
                    <td>45 parents notified of outstanding fees</td>
                </tr>
                <tr>
                    <td>Jan 15</td>
                    <td><span class="tag tag-info">Headmaster</span></td>
                    <td>Generated term reports</td>
                    <td>482 reports printed and distributed</td>
                </tr>
            `;
        }
        
        // ===== MODAL MANAGEMENT =====
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // ===== SIMULATE OFFLINE MODE =====
        function simulateOffline() {
            const statusBadge = document.querySelector('.status-badge');
            const statusDot = document.querySelector('.status-dot');
            
            // Change to "offline" state
            statusBadge.innerHTML = `<div class="status-dot" style="background:#dc3545"></div> SIMULATING OFFLINE MODE...`;
            statusBadge.style.background = '#ffeaea';
            statusBadge.style.color = '#721c24';
            
            // Show a message
            showToast("âš ï¸ Internet Connection Lost", "Simulating offline mode. All features remain functional.", "warning");
            
            // Revert after 3 seconds
            setTimeout(() => {
                statusBadge.innerHTML = `<div class="status-dot"></div> OFFLINE MODE ACTIVE`;
                statusBadge.style.background = '#e8f5e9';
                statusBadge.style.color = '#155724';
                showToast("âœ… Connection Restored", "System seamlessly synced offline changes.", "success");
            }, 3000);
        }
        
        // ===== WEBSITE FUNCTIONS =====
        function openWebsiteEditor() {
            showToast("Website Editor", "Opening website content management system. You can edit all website pages here.", "info");
        }
        
        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            // Set default dates
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDate').value = today;
            document.getElementById('paymentDate').value = today;
            
            // Set student DOB to 14 years ago
            const dob = new Date();
            dob.setFullYear(dob.getFullYear() - 14);
            document.getElementById('studentDOB').value = dob.toISOString().split('T')[0];
            
            // Initialize char count for SMS
            updateCharCount();
            
            // Start with intro screen
            showScreen('intro-screen');
        });
    </script>
</body>
</html>
